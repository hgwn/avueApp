(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["supplementaryCertification"],{"0e5c":function(t,a,e){"use strict";function n(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15e5;return new Promise((function(e){if(t.file.size>a){var n=document.createElement("canvas"),i=n.getContext("2d"),s=new Image;s.src=t.content,s.onload=function(){n.width=400,n.height=300,i.drawImage(s,0,0,400,300),t.content=n.toDataURL(t.file.type,.92)}}e(t)}))}e.d(a,"a",(function(){return n}))},"2c92":function(t,a,e){"use strict";var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.isWechat?t._e():e("div",{staticClass:"header"},[e("div",{staticClass:"header_body"},[e("span",{staticClass:"goBack",on:{click:t.goBack}},[e("van-icon",{attrs:{name:"arrow-left"}})],1),e("div",{staticClass:"flex-vertical-centering"},[e("p",{staticClass:"textEllipsis",on:{click:t.showLog}},[t._v("\n        "+t._s(t.headerName)+"\n      ")])]),t.shareShow?e("span",{staticClass:"shareSheet",on:{click:t.shareSheet}},[t._v("分享")]):t._e()])])},i=[],s={name:"TopMsg",props:{headerName:{type:String,default:""},required:{type:Boolean,default:!0},shareShow:{type:Boolean,default:!1}},data:function(){return{clickNum:0}},computed:{isWechat:function(){return this.$store.state.isWechat}},watch:{$route:function(){this.clickNum=0}},created:function(){},methods:{goBack:function(){var t=this;t.$router.go(-1)},shareSheet:function(){this.$emit("shareSheet")},showLog:function(){if(this.clickNum++,5===this.clickNum){this.clickNum=0;var t=document.getElementsByClassName("vc-switch")[0],a=window.getComputedStyle(t,null).getPropertyValue("display");"block"===a?VCONSOLE.hide():VCONSOLE.show()}}}},r=s,l=(e("88d0"),e("2877")),c=Object(l["a"])(r,n,i,!1,null,"0fe7e72d",null);a["a"]=c.exports},"65d6":function(t,a,e){},"88d0":function(t,a,e){"use strict";var n=e("a4c5"),i=e.n(n);i.a},a4c5:function(t,a,e){},f50f:function(t,a,e){"use strict";var n=e("65d6"),i=e.n(n);i.a},fa4a:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("top-msg",{attrs:{"header-name":"补充认证"}}),e("div",{staticClass:"con_body"},[e("div",{staticClass:"box"},[e("div",{staticClass:"line flex-row-center"},[e("span",{staticClass:"line_left"},[t._v("手机号码")]),e("span",[t._v(t._s(t.phone))])]),e("div",{staticClass:"line flex-row-center"},[e("span",{staticClass:"line_left"},[t._v("姓名")]),e("span",[t._v(t._s(t.name))])]),e("div",{staticClass:"line flex-row-center"},[e("span",{staticClass:"line_left"},[t._v("身份证")]),e("span",[t._v(t._s(t.id_card_no))])]),e("div",{staticClass:"line"},[e("div",{staticClass:"form_cell_upload flex_sa"},[e("div",{staticClass:"upload_item flex_column flex_alCen"},[t.cardImgFront.url?[e("div",{staticClass:"cell_uploadImg"},[t.cardImgFront.fileData?e("img",{attrs:{src:t.cardImgFront.url}}):[e("img",{attrs:{src:t.cardImgFront.url}}),e("van-loading")],e("span",{staticClass:"upload_close",on:{click:function(a){return t.deleteImg("cardImgFront")}}})],2)]:[e("div",{staticClass:"cell_uploadImg"},[e("van-uploader",{attrs:{"after-read":t.onCardImgFront}},[e("span",{staticClass:"upload_add"},[t._v("+")])])],1)],e("p",{staticClass:"color333 size24"},[t._v("\n              身份证正面照\n            ")])],2),e("div",{staticClass:"upload_item flex_column flex_alCen"},[t.cardImgAfter.url?[e("div",{staticClass:"cell_uploadImg"},[t.cardImgAfter.fileData?e("img",{attrs:{src:t.cardImgAfter.url}}):[e("img",{attrs:{src:t.cardImgAfter.url}}),e("van-loading")],e("span",{staticClass:"upload_close",on:{click:function(a){return t.deleteImg("cardImgAfter")}}})],2)]:[e("div",{staticClass:"cell_uploadImg"},[e("van-uploader",{attrs:{"after-read":t.onCardImgAfter}},[e("span",{staticClass:"upload_add"},[t._v("+")])])],1)],e("p",{staticClass:"color333 size24"},[t._v("\n              身份证反面照\n            ")])],2),e("div",{staticClass:"upload_item flex_column flex_alCen"},[t.cardImgHold.url?[e("div",{staticClass:"cell_uploadImg"},[t.cardImgHold.fileData?e("img",{attrs:{src:t.cardImgHold.url}}):[e("img",{attrs:{src:t.cardImgHold.url}}),e("van-loading")],e("span",{staticClass:"upload_close",on:{click:function(a){return t.deleteImg("cardImgHold")}}})],2)]:[e("div",{staticClass:"cell_uploadImg"},[e("van-uploader",{attrs:{"after-read":t.onCardImgHold}},[e("span",{staticClass:"upload_add"},[t._v("+")])])],1)],e("p",{staticClass:"color333 size24"},[t._v("\n              手持证件照\n            ")])],2)])]),e("div",{staticClass:"tip"},[t._v("\n        说明：请提交身份证图片资质信息\n      ")])])]),e("div",{staticClass:"btn_footer"},[e("div",{staticClass:"flex-vertical-centering"},[e("div",{staticClass:"btn btn_submit",on:{click:t.supplementaryFun}},[t._v("\n        确认提交\n      ")])])])],1)},i=[],s=e("2c92"),r=e("0e5c"),l={name:"SupplementaryCertification",components:{topMsg:s["a"]},data:function(){return{name:"",id_card_no:"",phone:"",postMsg:{},cardImgFront:{url:"",file:"",fileData:"",imgType:""},cardImgAfter:{url:"",file:"",fileData:"",imgType:""},cardImgHold:{url:"",file:"",fileData:"",imgType:""}}},computed:{token:function(){return this.$store.state.token}},created:function(){this.thisTitle(),this.getAuthenticationFun(),this.postMsg=this.$store.state.orderData},methods:{thisTitle:function(){document.title="补充认证"},supplementaryFun:function(){var t=this,a=this,e=function(t){return a.$dialog({title:t,showCancelButton:!1,confirmButtonText:"确定",className:"dialog",closeOnClickOverlay:!0})};if(a.cardImgFront.url)if(a.cardImgAfter.url)if(a.cardImgHold.url)if(a.cardImgFront.fileData&&a.cardImgAfter.fileData&&a.cardImgHold.fileData){var n={channel_code:a.postMsg.channel_code,credit_card_id:a.postMsg.deposit_bank_id,debit_card_id:a.postMsg.payback_bank_id,id_card_front_image:a.cardImgFront.fileData,id_card_in_hand_image:a.cardImgAfter.fileData,id_card_opposite_image:a.cardImgHold.fileData};a.$dialog({title:"确认补充认证",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",className:"dialog",closeOnClickOverlay:!0}).then((function(){a.isLoading=t.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"请稍候..."}),a.$api.card.registrationChannels(n).then((function(t){t=t.data,"200000"===t.code&&a.payment()}))})).catch((function(){console.log("cancel")}))}else e("图片正在上传，请上传完毕之后再点击提交");else e("请上传手持证件照");else e("请上传身份证反面照");else e("请上传身份证正面照")},getAuthenticationFun:function(){var t=this;t.$api.center.getAuthentication().then((function(a){t.name=a.data.data.id_card_name,t.id_card_no=a.data.data.id_card_no,t.phone=a.data.data.bank_card_phone_num}))},onCardImgFront:function(t){var a=this;this.cardImgFront.url=t.content,Object(r["a"])(t).then((function(t){a.cardImgFront.file=t.file,console.log(a.cardImgFront.file),a.uploadCardImgFun(a.cardImgFront.file,"ID_CARD_FRONT_IMAGE")}))},onCardImgAfter:function(t){var a=this;this.cardImgAfter.url=t.content,Object(r["a"])(t).then((function(t){a.cardImgAfter.file=t.file,a.uploadCardImgFun(a.cardImgAfter.file,"ID_CARD_OPPOSITE_IMAGE")}))},onCardImgHold:function(t){var a=this;this.cardImgHold.url=t.content,Object(r["a"])(t).then((function(t){a.cardImgHold.file=t.file,a.uploadCardImgFun(a.cardImgHold.file,"ID_CARD_IN_HAND_IMAGE")}))},uploadCardImgFun:function(t,a){var e=this,n=new FormData;n.append("file",t);var i=new XMLHttpRequest;i.open("post","http://app.zhr168.com/api/image/upload?target="+a,!0);var s="Bearer "+e.token.replace(/[\"]/g,"");i.setRequestHeader("Authorization",s),i.onreadystatechange=function(){if(4===i.readyState){var t=JSON.parse(i.response);200===i.status?"ID_CARD_FRONT_IMAGE"===a?e.cardImgFront.fileData=t.data.file_name:"ID_CARD_OPPOSITE_IMAGE"===a?e.cardImgAfter.fileData=t.data.file_name:"ID_CARD_IN_HAND_IMAGE"===a&&(e.cardImgHold.fileData=t.data.file_name):e.$dialog({title:"提交失败，请重新提交",showCancelButton:!1,confirmButtonText:"确定",className:"dialog",closeOnClickOverlay:!0})}},i.send(n)},deleteImg:function(t){"cardImgFront"===t?(this.cardImgFront.url="",this.cardImgFront.file="",this.cardImgFront.fileData=""):"cardImgAfter"===t?(this.cardImgAfter.url="",this.cardImgAfter.file="",this.cardImgAfter.fileData=""):"cardImgHold"===t&&(this.cardImgHold.url="",this.cardImgHold.file="",this.cardImgHold.fileData="")}}},c=l,o=(e("f50f"),e("2877")),d=Object(o["a"])(c,n,i,!1,null,"0b43dd38",null);a["default"]=d.exports}}]);