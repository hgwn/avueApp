(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["intelligence"],{"0e52":function(t,e,a){},2626:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"top"},[i("img",{attrs:{src:a("e3ee")},on:{click:function(e){return t.$router.push("/planList")}}}),i("div",{staticClass:"text"},[t._v("\n        银行卡签约\n      ")])]),t.boxShow?i("div",{staticClass:"con_body"},[i("div",{staticClass:"form_cells form_cells_form bgfff"},[i("div",{staticClass:"form_cell"},[t._m(0),i("div",{staticClass:"form_cellBd"},[i("span",{staticClass:"size30"},[t._v(t._s(t.creditCardId))])])]),i("div",{staticClass:"form_cell"},[t._m(1),i("div",{staticClass:"form_cellBd"},[i("span",{staticClass:"size30"},[t._v(t._s(t.bankSelect.name))])])]),i("div",{staticClass:"form_cell"},[t._m(2),i("div",{staticClass:"form_cellBd"},[i("span",[t._v(t._s(t.CVN2))])])]),i("div",{staticClass:"form_cell"},[t._m(3),i("div",{staticClass:"form_cellBd"},[i("span",{staticClass:"size30 inline_block w30"},[t._v(t._s(t.validityMonthSelect?t.validityMonthSelect:""))]),i("span",[t._v("月")]),i("span",{staticClass:"w10 inline_block cen",staticStyle:{color:"#BEBEBE"}},[t._v(" / ")]),i("span",{staticClass:" size30 inline_block w30"},[t._v(t._s(t.validityYearSelect?t.validityYearSelect:""))]),i("span",[t._v("年")])])]),i("div",{staticClass:"form_cell"},[t._m(4),i("div",{staticClass:"form_cellBd"},[i("span",[t._v(t._s(t.tel))])])]),t._e()]),i("div",{staticClass:"btn_warp"},[i("button",{staticClass:"btn btn_add",on:{click:t.gotoBindCardHK}},[t._v("\n          签 约\n        ")])])]):t._e(),t.boxShow?t._e():[i("iframe",{ref:"iframe",staticStyle:{width:"100%",height:"600px"},attrs:{id:"bdIframe",scrolling:"no",frameborder:"no",src:t.htmlurl}})]],2)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form_cellHd"},[a("label",{staticClass:"form_label"},[t._v("银行卡号")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form_cellHd"},[a("label",{staticClass:"form_label"},[t._v("所属银行")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form_cellHd"},[a("label",{staticClass:"form_label"},[t._v("CVN2")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form_cellHd"},[a("label",{staticClass:"form_label"},[t._v("有效期")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form_cellHd"},[a("label",{staticClass:"form_label"},[t._v("预留手机号")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form_cellHd"},[a("label",{staticClass:"form_label"},[t._v("验证码")])])}],n=(a("e17f"),a("2241")),o=(a("5f5f"),a("f253")),r=(a("e7e5"),a("d399")),l=a("2c92"),c=(a("5b4d"),a("2b0e"));a("41cb");function d(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}c["default"].use(r["a"]);var u={name:"BindCardHT",components:d({topMsg:l["a"]},o["a"].name,o["a"]),props:["fromIntelligencePage","hideBindCard","cId","cCode"],data:function(){return{boxShow:!0,htmlurl:"",cardId:this.$util.getQueryVariable("cardId"),channelCode:this.$util.getQueryVariable("channelCode"),creditCardId:"",cardName:"",CVN2:"",validity:"",tel:"",code:"",isGetCode:!1,num:60,timer:"",bankSelect:{},bankListArr:[],validityMonthList:[],validityMonthSelect:"",validityYearList:[],validityYearSelect:"",bizOrderNumber:""}},computed:{currentCreditCard:function(){return this.$store.state.currentCreditCard},settleMsg:function(){return this.$store.state.settleMsg},orderData:function(){return this.$store.state.orderData},bankList:function(){return this.$store.state.bankList}},created:function(){this.fromIntelligencePage&&(this.cardId=this.cId,this.channelCode=this.cCode);for(var t=1;t<13;t++)t<10?this.validityMonthList.push("0"+t):this.validityMonthList.push(t);for(var e=18;e<100;e++)this.validityYearList.push("20"+e);this.thisTitle(),this.getBankListFun(),this.getCreditCardMsg()},methods:{thisTitle:function(){document.title="获取验证码"},getCodeFun1:function(){var t=this;t.isGetCode||(console.log("获取验证码"),t.isGetCode=!0,t.timer=setInterval((function(){0!==t.num?t.num--:(t.isGetCode=!1,t.num=60,clearInterval(t.timer))}),1e3));var e={creditCardId:t.creditCardId,tel:t.tel};t.$api.card.getVerificationCode("CREDIT",e).then((function(e){console.log("进入渠道绑卡"),t.codeToken=e.data.token,console.log(e),console.log(t.codeToken)})).catch((function(){t.isGetCode=!1,t.num=60,clearInterval(t.timer)}))},open:function(t,e){var a=this;if(a.url=t,a.title=e,"#"===t)Object(n["a"])({title:"提示",message:"即将上线，敬请期待！",confirmButtonText:"确定"});else{var i=navigator.userAgent,s=i.indexOf("Android")>-1||i.indexOf("Adr")>-1,o=!!i.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);if(s){var r=e+"###"+t+"###http://www.zhsc198.com/";baiwangxinxi.OpenWechat(r)}if(o){var l={title:e,url:t,referer:"http://www.zhsc198.com/"};window.webkit.messageHandlers.OpenWechat.postMessage(l)}}},submit:function(){var t=this;t.$api.card.bindChannelCard("CREDIT",t.cardId,t.channelCode).then((function(e){console.log(e.data.data.state);var a=e.data.data.html;a?(t.open(a,"银行卡签约"),t.isLoading.clear()):(t.$router.go(-1),t.isLoading.clear())})).catch((function(e){console.log(e),t.isLoading.clear(),t.$router.go(-1)}))},gotoBindCardHK:function(){var t=this,e=this;e.$dialog({title:"确定即发起银行卡签约",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",className:"dialog",closeOnClickOverlay:!0}).then((function(){e.isLoading=t.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"请稍候..."}),e.submit()})).catch((function(){console.log("cancel")}))},getCreditCardMsg:function(){if(console.log("获取信用卡信息"),console.log(this.currentCreditCard),this.creditCardId=this.currentCreditCard.card_info.card_no.replace(/\s/g,"").replace(/(\d{4})(?=\d)/g,"$1 "),this.$set(this.bankSelect,"name",this.currentCreditCard.bank_info.name),this.$set(this.bankSelect,"bank_no",this.currentCreditCard.bank_info.bank_no),this.CVN2=this.currentCreditCard.card_info.lass_three_cvn2,this.validity=this.currentCreditCard.card_info.valid_date,-1!==this.currentCreditCard.card_info.valid_date.indexOf("/")){var t=this.currentCreditCard.card_info.valid_date.split("/");this.validityMonthSelect=t[0],this.validityYearSelect="20"+t[1]}else this.validityMonthSelect=this.currentCreditCard.card_info.valid_date.substr(0,2),this.validityYearSelect="20"+this.currentCreditCard.card_info.valid_date.substr(2);this.tel=this.currentCreditCard.card_info.card_phone_number},confirmBindCard:function(){var t=this;if(t.code){var e={captcha_code:t.code};t.isLoading=this.$toast.loading({duration:3e3,forbidClick:!0,loadingType:"spinner",message:"请稍候..."}),t.$api.card.bindChannelCardConfirm("CREDIT",t.cardId,t.channelCode,t.bizOrderNumber,e).then((function(e){var a=e.data.data.state,i=e.data.data.errorMsg;"000"!=a?Object(r["a"])(i):(Object(r["a"])(i),t.hideBindCard(),t.$emit("toSuccess"),t.isLoading.clear())}))}else t.$dialog({title:"请输入收到的验证码",showCancelButton:!1,confirmButtonText:"确定",className:"dialog",closeOnClickOverlay:!0})},payFun:function(){var t=this;return t.$api.proceeds.tradePay(t.orderData).then((function(e){t.isLoading.clear(),e=e.data,"200000"===e.code&&("INTERNAL_PAGE"===t.settleMsg.pay_provider_config.param_type?t.$dialog({title:"交易完成",showCancelButton:!1,confirmButtonText:"确定",className:"dialog",closeOnClickOverlay:!0}):"EXTERNAL_URL"===t.settleMsg.pay_provider_config.param_type&&(window.location.href=e.data.url))})).then((function(){t.isLoading.clear(),t.$router.push("/proceeds")}),(function(){t.isLoading.clear(),t.$router.push("/proceeds")}))},closeStatusPicker:function(t){this.bankSelect=t,this.bankPicker=!1,this.openTouch()},closeValidityMonth:function(t){this.validityMonthSelect=t,this.validityMonthPicker=!1,this.openTouch()},closeValidityYear:function(t){this.validityYearSelect=t,this.validityYearPicker=!1,this.openTouch()},getBankListFun:function(){var t=this;t.$store.dispatch("GetBankList").then((function(){for(var e in t.bankList)t.bankListArr.push({bankNo:e,text:t.bankList[e]})}))},selectCard:function(t){this.bankSelect=t,this.bankPicker=!1}},mounted:function(){var t=document.getElementById("bdIframe"),e=(document.documentElement.clientWidth,document.documentElement.clientHeight);t.style.height=Number(e)+"px"}},h=u,p=(a("65c6"),a("2877")),m=Object(p["a"])(h,i,s,!1,null,"40d66cb1",null);e["a"]=m.exports},"2a26":function(t,e,a){},"4bea":function(t,e){t.exports="data:image/png;base64,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"},6409:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"intelligence-page"},[i("top-msg",{attrs:{"header-name":"添加懒鬼计划"}}),i("ul",{staticClass:"top-list"},[i("li",{staticClass:"clear item",on:{click:function(e){t.showSelectCard=!0}}},[i("span",{staticClass:"lt text"},[t._v("选择信用卡")]),i("span",{staticClass:"rt intro"},[t._v("\n        "+t._s(t.bankMsg.bank_info&&t.bankMsg.bank_info.name)+t._s(0===Object.keys(t.bankMsg).length&&t.bankMsg.constructor===Object?"":"（尾号")+t._s(t.bankMsg&&t.bankMsg.card_no)+t._s(0===Object.keys(t.bankMsg).length&&t.bankMsg.constructor===Object?"":"）")+"\n        "),i("van-icon",{attrs:{name:"arrow"}})],1)]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("还款总金额")]),i("span",{staticClass:"rt"},[i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.repay_sum_amount,expression:"repay_sum_amount",modifiers:{number:!0}}],staticClass:"input-box",attrs:{type:"number"},domProps:{value:t.repay_sum_amount},on:{change:t.changeNum,input:function(e){e.target.composing||(t.repay_sum_amount=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("信用卡预留金额")]),i("span",{staticClass:"rt"},[i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.principal_amount,expression:"principal_amount",modifiers:{number:!0}}],staticClass:"input-box",attrs:{type:"number"},domProps:{value:t.principal_amount},on:{input:function(e){e.target.composing||(t.principal_amount=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),i("li",{staticClass:"clear item",staticStyle:{display:"none"}},[i("span",{staticClass:"lt text"},[t._v("消费类型")]),i("span",{staticClass:"rt"},[i("span",{staticClass:"input-box",attrs:{type:"text"},on:{click:function(e){t.showPicker=!0}}},[t._v(t._s(t.repay_type))]),i("van-icon",{attrs:{name:"arrow"}})],1)]),i("van-popup",{attrs:{position:"bottom"},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[i("van-picker",{attrs:{"show-toolbar":"",columns:t.columns},on:{cancel:function(e){t.showPicker=!1},confirm:t.onConfirm}})],1),i("li",{staticClass:"clear item",on:{click:t.showDateSelectFun}},[i("span",{staticClass:"lt text"},[t._v("选择还款日期")]),i("van-icon",{staticClass:"rt",attrs:{name:"arrow"}}),t.dates.length>0?i("span",{staticClass:"rt repay-dates textEllipsis"},t._l(t.dates,(function(e,a){return i("span",{key:a,staticClass:"text"},[t._v(t._s(e.getDate())+", ")])})),0):t._e()],1),i("li",{staticClass:"clear item",staticStyle:{display:"none"}},[i("span",{staticClass:"lt text"},[t._v("每天还款笔数")]),i("span",{staticClass:"calc-box rt"},[i("img",{staticClass:"img-btn",attrs:{src:a("ffeb")},on:{click:function(e){t.value>1?t.value--:t.value=1}}}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"input",attrs:{type:"text",readonly:"readonly"},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}}),i("img",{staticClass:"img-btn",attrs:{src:a("4bea")},on:{click:function(e){t.value<t.repay_type_list.length?t.value++:t.value=t.repay_type_list.length}}})])]),i("li",{staticClass:"clear item",on:{click:function(e){t.showSelectAddress=!0}}},[i("span",{staticClass:"lt text"},[t._v("选择省市")]),i("van-icon",{staticClass:"rt",attrs:{name:"arrow"}}),i("span",{staticClass:"rt text"},[t._v(t._s(t.selectedAreaList.all))])],1)],1),i("div",{staticClass:"add-btn flex-vertical-centering",on:{click:t.addBill}},[t._m(0)]),t.billList.length>0?i("div",{staticClass:"msg-box"},[i("div",{staticClass:"situation"},[i("div",{staticClass:"reset-btn",on:{click:t.toResetFun}},[i("div",{staticClass:"text"},[t._v("\n          账单\n        ")]),i("div",{staticClass:"text"},[t._v("\n          重置\n        ")])]),i("div",{staticClass:"item"},[i("div",{staticClass:"clear title"},[i("span",{staticClass:"lt text"},[t._v("定制时间："+t._s(t._f("timeToFormatDay")(t.billMsg.time)))]),i("span",{staticClass:"rt text"},[t._v("共"+t._s(t.billMsg.repayNum)+"笔")])]),i("div",{staticClass:"clear dec"},[i("span",{staticClass:"lt text"},[t._v("账单总金额：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.order_total_money)+"元")])]),i("span",{staticClass:"rt text"},[t._v("手续费：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.service_fee)+"元")])])]),i("div",{staticClass:"clear dec"},[i("span",{staticClass:"lt text"},[t._v("费率：\n            "),i("span",{staticClass:"price"},[t._v(t._s((100*t.billMsg.consume_rate).toFixed(2))+"%，"+t._s((100*t.billMsg.big_money_user_rate).toFixed(2))+"%")])]),i("span",{staticClass:"rt text"},[t._v(t._s(t.refundName)+"：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.fee_refund_money)+"元")])])]),i("div",{staticClass:"clear remaining"},[i("span",{staticClass:"lt text"},[t._v("提醒：本次计划信用卡余额不少于：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.marginAmount)+"元")])])])])]),i("ul",{staticClass:"list"},t._l(t.billList,(function(e,s){return i("li",{key:s,staticClass:"item"},[i("div",{staticClass:"title clear"},[i("span",{staticClass:"lt text"},[i("img",{attrs:{src:a("ad29")}}),t._v("\n            账单¥"+t._s(e.plan_bill_info&&e.plan_bill_info.amount)+"\n          ")]),i("span",{staticClass:"rt date"},[t._v(t._s(t._f("timeToFormatDay")(e.json_execute_time)))])]),i("ul",{staticClass:"item-list"},t._l(e.consume_bills,(function(e,a){return i("li",{key:a,staticClass:"list-item clear"},[i("span",{staticClass:"lt text"},[t._v("消费（¥"+t._s(e.plan_bill_info&&e.plan_bill_info.amount)+"）")]),i("span",{staticClass:"lt text",staticStyle:{"padding-left":"20px"}},[t._v(t._s(t.refundName)+"（¥"+t._s(e.plan_bill_info&&e.plan_bill_info.fee_refund_money)+"）")]),i("span",{staticClass:"rt",staticStyle:{"padding-left":"5px"},on:{click:function(i){return t.editTime(e.json_execute_time,s,a)}}},[t._v("编辑")]),i("span",{staticClass:"rt text"},[t._v(t._s(t._f("timeToFormatTime")(e.json_execute_time)))])])})),0)])})),0)]):t._e(),t.billList.length>0?i("div",{staticClass:"bottom-add-btn"},[i("span",{staticClass:"btn",on:{click:t.submit}},[t._v("提交账单")])]):t._e(),i("van-popup",{staticClass:"date-select",attrs:{position:"bottom"},model:{value:t.showTimeSelect,callback:function(e){t.showTimeSelect=e},expression:"showTimeSelect"}},[i("div",{staticClass:"title"},[t._v("\n      请自定义消费时间\n    ")]),i("ul",{staticClass:"top-list"},[i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("时")]),i("span",{staticClass:"rt"},[i("van-stepper",{attrs:{min:"0",max:"23"},model:{value:t.hour,callback:function(e){t.hour=e},expression:"hour"}})],1)]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("分")]),i("span",{staticClass:"rt"},[i("van-stepper",{attrs:{min:"0",max:"59"},model:{value:t.minute,callback:function(e){t.minute=e},expression:"minute"}})],1)]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("秒")]),i("span",{staticClass:"rt"},[i("van-stepper",{attrs:{min:"0",max:"59"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)])]),i("div",{staticClass:"confirm-btn",on:{click:t.closeTime}},[t._v("\n      确定\n    ")])]),i("select-card",{attrs:{"show-select-card":t.showSelectCard,"hide-select-card":t.hideSelectCardFun,"show-add-card-flag":t.showAddCardFlag,"current-nav":1},on:{selectedCard:t.selectedCardFun,showAddCard:t.showAddCardFun}}),i("select-card",{attrs:{"show-select-card":t.showSelectDepositCard,"hide-select-card":t.hideSelectDepositCardFun,"show-add-card-flag":t.showAddDepositCardFlag,"current-nav":0},on:{selectedCard:t.selectedDepositCardFun,showAddCard:t.showAddDepositCardFun}}),i("van-popup",{staticClass:"date-select",attrs:{position:"bottom"},model:{value:t.showDateSelect,callback:function(e){t.showDateSelect=e},expression:"showDateSelect"}},[i("div",{staticClass:"title"},[t._v("\n      请选择到期日期\n    ")]),i("v-date-picker",{staticClass:"date-picker",attrs:{"title-position":"center",mode:"multiple","is-required":!0,"min-date":t.minDate,"max-date":t.maxDate,"is-inline":!0,"disabled-attribute":{contentStyle:{color:"#999999"}},"select-attribute":{highlight:{color:"#000",backgroundColor:"#999999"}}},model:{value:t.dates,callback:function(e){t.dates=e},expression:"dates"}}),i("div",{staticClass:"confirm-btn",on:{click:t.getDate}},[t._v("\n      确定\n    ")])],1),i("van-popup",{staticClass:"picker",attrs:{position:"bottom"},model:{value:t.showSelectAddress,callback:function(e){t.showSelectAddress=e},expression:"showSelectAddress"}},[i("van-area",{attrs:{"area-list":t.areaList,"columns-num":2,title:"选择地址"},on:{confirm:function(e){return t.determine(e)},cancel:t.cancel}})],1),i("confirm-bill",{attrs:{"bank-card-id":t.bankMsg.id,"min-date":t.fromDate,"max-date":t.endDate,"show-confirm-bill":t.showConfirmBill,"to-hide-confirm-bill":t.hideConfirmBillFun,"to-show-confirm-bill":t.showConfirmBillFun,"from-intelligence-page":!0,"check-bill-list":t.billMsg,"confirm-msg-list":t.billList,"c-rate":t.z_user_rate,"list-data":t.ReplayBillModifyReq}}),t.isbindCard?i("div",{staticClass:"add-page"},[t.isbindCardhk?t._e():[i("bind-card",{attrs:{"from-intelligence-page":!0,"hide-bind-card":t.hideBindCardFun,"c-id":t.bankMsg.id,"c-code":t.channel_code},on:{toSuccess:t.showConfirmBillFun}})],t.isbindCardhk?[i("bind-cardh",{attrs:{"from-intelligence-page":!0,"hide-bind-card":t.hideBindCardFun,"c-id":t.bankMsg.id,"c-code":t.channel_code},on:{toSuccess:t.showConfirmBillFun}})]:t._e()],2):t._e()],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex-row-center"},[a("i",{staticClass:"iconfont icon-jia"}),a("span",[t._v("制定账单")])])}],n=a("a34a"),o=a.n(n),r=(a("e7e5"),a("d399")),l=a("dd6f"),c=a("494e"),d=a("3462"),u=a("c466"),h=a("2c92"),p=a("f933"),m=a("2626");function _(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?_(Object(a),!0).forEach((function(e){g(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function g(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function b(t,e,a,i,s,n,o){try{var r=t[n](o),l=r.value}catch(c){return void a(c)}r.done?e(l):Promise.resolve(l).then(i,s)}function C(t){return function(){var e=this,a=arguments;return new Promise((function(i,s){var n=t.apply(e,a);function o(t){b(n,i,s,o,r,"next",t)}function r(t){b(n,i,s,o,r,"throw",t)}o(void 0)}))}}var v={name:"Intelligence",components:{selectCard:l["a"],confirmBill:d["a"],topMsg:h["a"],bindCard:p["default"],bindCardh:m["a"]},filters:{timeToFormatDay:u["c"],timeToFormatDate:u["b"],timeToFormatTime:u["d"]},data:function(){return{showTimeSelect:!1,Times:"",date:"",hour:"",minute:"",time:"",index:"",i:"",timestamp:"",ReplayBillModifyReq:[],isbindCard:!1,isbindCardhk:!1,showSelectDepositCard:!1,showAddDepositCardFlag:!1,showSelectCard:!1,showDateSelect:!1,dates:[],repay_days:[],maxDate:new Date((new Date).setDate(31)),minDate:new Date((new Date).setDate(1)),currentDate:new Date,currentValue:new Date,value:2,reapyType:2,principal_amount:"",repayCountPerDay:1,repay_type:"2消1还",columns:["1消1还","2消1还","3消1还"],repay_type_list:[1,2,3],showPicker:!1,repay_sum_amount:"",showSelectAddress:!1,areaList:{},selectedAreaList:{},showConfirmBill:!1,bankMsg:{},repayConstraint:{},billList:[],refundName:"智慧金",billMsg:{time:"",service_fee:"",usePrice:"",repayPrice:"",useNum:0,repayNum:0,consume_rate:"",repay_service_fee:"",json_trade_no:"",fee_refund_money:"",order_total_money:""},channel_code:this.$route.query.code,z_user_rate:this.$route.query.z_user_rate||"",cardId:"",cardType:"CREDIT",cardId1:"",cardType1:"DEBIT",showAddCardFlag:!1,min_count:null,max_count:null}},computed:{cityRecord:{get:function(){return JSON.parse(localStorage.getItem("intelligenceArea"))},set:function(t){localStorage.setItem("intelligenceArea",JSON.stringify(t))}},fromDate:function(){return this.repay_days.length>0?new Date(this.repay_days[0]):new Date},endDate:function(){return this.repay_days.length>0?new Date(this.repay_days[this.repay_days.length-1]):new Date}},watch:{dates:function(t,e){this.repay_days=[];var a=!0,i=!1,s=void 0;try{for(var n,o=t[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var r=n.value;this.repay_days.push(r.getTime())}}catch(l){i=!0,s=l}finally{try{a||null==o.return||o.return()}finally{if(i)throw s}}},billList:function(t,e){var a=0,i=0,s=!0,n=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(s=(r=l.next()).done);s=!0){var c=r.value;a+=parseFloat(c.plan_bill_info.amount);var d=!0,u=!1,h=void 0;try{for(var p,m=c.consume_bills[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var _=p.value;i+=parseFloat(_.plan_bill_info.amount)}}catch(f){u=!0,h=f}finally{try{d||null==m.return||m.return()}finally{if(u)throw h}}}}catch(f){n=!0,o=f}finally{try{s||null==l.return||l.return()}finally{if(n)throw o}}this.billMsg.repayPrice=a.toFixed(2),this.billMsg.usePrice=i.toFixed(2)}},beforeRouteLeave:function(t,e,a){this.showAddCardFlag?(this.showAddCardFlag=!1,a(!1)):this.showAddDepositCardFlag?(this.showAddDepositCardFlag=!1,a(!1)):this.isbindCard?(this.isbindCard=!1,a(!1)):a()},created:function(){document.title="懒鬼计划",this.areaList=c["a"],this.getRepayConstraint(),this.getRepayCount(),this.getDefaultAddress()},methods:{getDefaultAddress:function(){var t=this;t.$api.center.getDefaultAddress().then((function(e){console.warn("获取默认地址....."),e.data.data&&e.data.data.address_info&&e.data.data.address_info.address_tag?(console.log(e.data.data.address_info.address_tag),t.selectedAreaList=JSON.parse(e.data.data.address_info.address_tag)):t.cityRecord&&(t.selectedAreaList=t.cityRecord)}))},onConfirm:function(t){this.repay_type=t,"1消1还"==this.repay_type&&(this.reapyType=1),"2消1还"==this.repay_type&&(this.reapyType=2),"3消1还"==this.repay_type&&(this.reapyType=3),this.getRepayCount(),this.showPicker=!1},changeNum:function(){this.repay_sum_amount&&(this.principal_amount=Math.floor(100*parseInt(this.repay_sum_amount)/1e3),console.log(this.repay_sum_amount))},bbbindChannelCard:function(t,e,a){var i=this,s=this;s.$api.card.bbbindChannelCard(t,e,a).then((function(t){console.log("查询渠道绑卡状态成功"),console.log(t.data.data.data.signature);var e=t.data.data.data.signature,a=t.data.data.data.signType;2!=e?(i.isbindCard=!0,3==a&&(i.isbindCardhk=!0)):i.showConfirmBill=!0})).catch((function(t){console.log(t),Object(r["a"])("服务异常")}))},getCodeFun:function(t,e){var a=this;a.$api.card.bindChannelCard("CREDIT",t,e).then((function(t){console.log(t.data.data.state);var e=t.data.data.html;e&&a.$router.push({path:"/iframe",query:{url:e,title:"签约"}})})).catch((function(t){console.log(t)}))},registjudge:function(t){var e=this,a=this;a.$api.card.registjudge(t).then((function(t){console.log(t.data.data.state);var i=t.data.data.state;4!=i?a.showSelectDepositCard=!0:a.bbbindChannelCard(e.channel_code,e.cardId,e.cardType)})).catch((function(t){console.log(t)}))},getCardListFun:function(){},registrationChannels:function(t){var e=this,a={channel_code:e.channel_code,credit_card_id:e.bankMsg.id,debit_card_id:t};e.$api.card.registrationChannels(a).then((function(t){console.log("注册渠道信息"),console.log(a),console.log(t),"200000"===t.data.code&&(e.showConfirmBill=!0)})).catch((function(t){console.log(t);var a=t.data;"921006"!==a.code&&"921010"!==a.code||(e.isbindCard=!0)}))},hideSelectDepositCardFun:function(){this.showSelectDepositCard=!1},selectedDepositCardFun:function(t){var e=this,a=this;console.log("选择的储蓄卡"),console.log(t),a.depositbankMsg=t,a.cardId1=this.depositbankMsg.id,console.log(a.cardId1),a.$api.card.regchannel(a.cardType1,a.cardId1,a.channel_code).then((function(t){console.log(t.data.data.isSign),console.log(t.data.data.state);var i=t.data.data.isSign,s=t.data.data.state;console.log(i),console.log(s),"t"==i&&"000"==s&&(console.log("签约"),a.bbbindChannelCard(e.channel_code,e.cardId,e.cardType))})).catch((function(t){console.log(t),Object(r["a"])("储蓄卡注册失败")}))},showAddDepositCardFun:function(t){this.showAddDepositCardFlag=t},hideBindCardFun:function(){this.isbindCard=!1},showAddCardFun:function(t){this.showAddCardFlag=t},editTime:function(t,e,a){console.warn(t),this.datetime=t,this.timestamp=t,this.date=Object(u["c"])(t),Object(u["d"])(t);this.billList[e].consume_bills[a].json_execute_time;var i=Object(u["d"])(t).split(":");this.hour=i[0],this.minute=i[1],this.time=i[2],this.showTimeSelect=!0,this.index=e,this.i=a},closeTime:function(){parseInt(this.hour)<10&&(this.hour="0"+this.hour),parseInt(this.minute)<10&&(this.minute="0"+this.minute),parseInt(this.time)<10&&(this.time="0"+this.time);var t=this.hour+":"+this.minute+":"+this.time,e=this.date.replace(/-/g,"/")+" "+t;console.log(e);var a=Date.parse(new Date(e));console.log(a),this.billList[this.index].consume_bills[this.i].json_execute_time=a,this.showTimeSelect=!1},getRefundName:function(){this.$api.plan.getRefundName(null).then((function(t){})).catch((function(t){console.log(t),Object(r["a"])("服务异常")}))},getRepayCount:function(){var t=this;this.$api.plan.getRepayCount({repay_type:this.reapyType}).then((function(e){console.warn("每天还款笔数获取.."),console.warn(e),t.repay_type_list=e.data.data.repay_type_list,t.value=2,console.warn(t.repay_type_list)})).catch((function(t){console.warn(t)}))},getRepayConstraint:function(){},toResetFun:function(){var t=this;this.$dialog({title:"提示",message:"是否要重置账单？",confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.resetFun()}))},resetFun:function(){this.billMsg={time:"",service_fee:"",usePrice:"",repayPrice:"",useNum:0,repayNum:0,consume_rate:"",repay_service_fee:"",fee_refund_money:"",order_total_money:""},this.billList=[]},addBill:function(){var t=this;return/(^[1-9]\d*$)/.test(this.repay_sum_amount)?0===this.billList.length?(this.toAddBill(),!1):void this.$dialog({title:"提示",message:"是否要重置账单？",confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.toAddBill()})):(this.$dialog({title:"温馨提示",message:"账单总金额需取整数，请重新输入账单总金额",confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){})),!1)},toAddBill:function(){var t=C(o.a.mark((function t(){var e,a=this;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e={bank_card_id:this.bankMsg.id,city_code:this.selectedAreaList.region,repay_days:this.repay_days,repay_sum_amount:100*this.repay_sum_amount,principal_amount:100*this.principal_amount},e.bank_card_id){t.next=6;break}return this.$toast.fail("请选择银行卡"),t.abrupt("return",!1);case 6:if(e.city_code){t.next=11;break}return this.$toast.fail("请选择城市"),t.abrupt("return",!1);case 11:if(e.repay_sum_amount){t.next=16;break}return this.$toast.fail("请输入账单金额"),t.abrupt("return",!1);case 16:if(e.principal_amount){t.next=19;break}return this.$toast.fail("请输入信用卡预留金额"),t.abrupt("return",!1);case 19:if(0!==this.max_count||0!==this.min_count){t.next=24;break}return this.$toast("账单金额过小"),t.abrupt("return",!1);case 24:if(!(e.repay_sum_count>this.max_count)){t.next=27;break}t.next=30;break;case 27:if(!(e.repay_sum_count<this.min_count)){t.next=30;break}return this.$toast("最小账单笔数不小于"+this.min_count+"笔"),t.abrupt("return",!1);case 30:this.$api.plan.genIntelligentV3(e).then((function(t){var e=[];if("200000"===t.data.code){console.log("智能生成代还计划"),console.log(t.data.data),a.z_user_rate=t.data.data.plan_info.repay_plan_info.big_money_user_rate,a.billMsg.time=t.data.data.plan_info.create_time,a.billMsg.useNum=parseInt(t.data.data.consume_count),a.billMsg.repayNum=parseInt(t.data.data.repay_count),a.billMsg.service_fee=t.data.data.service_fee,a.billMsg.marginAmount=t.data.data.margin_amount,a.billMsg.big_money_user_rate=t.data.data.plan_info.repay_plan_info.big_money_user_rate,a.billMsg.consume_rate=t.data.data.plan_info.repay_plan_info.consume_rate,a.billMsg.repay_service_fee=t.data.data.plan_info.repay_plan_info.repay_service_fee,a.billMsg.repayFee=t.data.data.plan_info.repay_plan_info.repay_fee,a.billMsg.fee_refund_money=t.data.data.plan_info.repay_plan_info.fee_refund_money,a.billMsg.json_trade_no=t.data.data.plan_info.json_trade_no,a.billMsg.order_total_money=t.data.data.plan_info.repay_plan_info.order_total_money;var i=!0,s=!1,n=void 0;try{for(var o,r=t.data.data.bills[Symbol.iterator]();!(i=(o=r.next()).done);i=!0){var l=o.value;e.push(l)}}catch(d){s=!0,n=d}finally{try{i||null==r.return||r.return()}finally{if(s)throw n}}a.billList=e;var c=t.data.data.delay_msg;c&&a.$dialog({title:"温馨提示",message:c,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){}))}else a.$toast(t.data.msg)}));case 31:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),showDateSelectFun:function(){if(0===Object.keys(this.bankMsg).length&&this.bankMsg.constructor===Object)return this.$toast("请先选择银行卡"),!1;this.showDateSelect=!0},cityChoice:function(){this.show=!0},determine:function(t){var e={};e.all=t[0].name+" "+t[1].name,e.province=t[0].name,e.city=t[1].name,e.region=t[1].code,Object.assign(this.selectedAreaList,e),this.showSelectAddress=!1,this.cityRecord=this.selectedAreaList},cancel:function(){this.showSelectAddress=!1},hideSelectCardFun:function(){this.showSelectCard=!1},getDate:function(){this.showDateSelect=!1},submit:function(){for(var t=[],e=0;e<this.billList.length;e++)for(var a=0;a<this.billList[e].consume_bills.length;a++){var i=this.billList[e].consume_bills[a].json_execute_time,s=this.billList[e].consume_bills[a].json_bill_no;t.push({plan_executed_time:i,bill_no:s})}console.log(t),this.ReplayBillModifyReq=t,this.registjudge(this.channel_code)},hideConfirmBillFun:function(){this.showConfirmBill=!1},showConfirmBillFun:function(){this.showConfirmBill=!0},judeRange:function(t,e){var a=parseInt(t),i=parseInt(e),s=new Date,n=s,o=s.getDate(),r=s.getMonth(),l=0;l=r<11?r+1:0,a<i?(o>=i&&(this.minDate=new Date(n.setMonth(r+1,a)),this.maxDate=new Date(n.setMonth(l,i-1))),o<=a&&(this.minDate=new Date(n.setMonth(r,a)),this.maxDate=new Date(n.setMonth(r,i-1))),o>a&&o<i&&(this.minDate=new Date(n.setMonth(r,o)),this.maxDate=new Date(n.setMonth(r,i-1)))):a>i&&(o>=e&&o>=a&&(this.minDate=new Date(n.setMonth(r,o)),this.maxDate=new Date(n.setMonth(r+1,i-1))),o>e&&o<a&&(this.minDate=new Date(n.setMonth(r,a)),this.maxDate=new Date(n.setMonth(r+1,i-1))),o<e&&(this.minDate=new Date(n.setMonth(r,o)),this.maxDate=new Date(n.setMonth(r,i-1)))),this.currentValue=this.minDate},selectedCardFun:function(t){var e=this;console.log("选择银行卡...."),console.log(t),this.bankMsg=t,this.bankMsg.card_no=this.bankMsg.card_info.card_no.substr(-4,4),this.cardId=t.id,this.$api.card.getCard("CREDIT",this.bankMsg.id).then((function(t){console.log("获取信用卡"),console.log(t);var a={id:t.data.data.id,card_info:f({},t.data.data),bank_info:t.data.data.bank_info};e.$store.commit("SET_CURRENT_CREDIT_CARD",a)})),this.judeRange(t.card_info.bill_date,t.card_info.repayment_date),this.dates=[],this.resetFun()}}},y=v,w=(a("d2d7"),a("2877")),x=Object(w["a"])(y,i,s,!1,null,"8464f1da",null);e["default"]=x.exports},"65c6":function(t,e,a){"use strict";var i=a("7754"),s=a.n(i);s.a},7754:function(t,e,a){},"921b":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"intelligence-page"},[i("top-msg",{attrs:{"header-name":"智能添加计划"}}),i("ul",{staticClass:"top-list"},[i("li",{staticClass:"clear item",on:{click:function(e){t.showSelectCard=!0}}},[i("span",{staticClass:"lt text"},[t._v("选择信用卡")]),i("span",{staticClass:"rt intro"},[t._v("\n        "+t._s(t.bankMsg.bank_info&&t.bankMsg.bank_info.name)+t._s(0===Object.keys(t.bankMsg).length&&t.bankMsg.constructor===Object?"":"（尾号")+t._s(t.bankMsg&&t.bankMsg.card_no)+t._s(0===Object.keys(t.bankMsg).length&&t.bankMsg.constructor===Object?"":"）")+"\n        "),i("van-icon",{attrs:{name:"arrow"}})],1)]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("账单总金额")]),i("span",{staticClass:"rt"},[i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.repay_sum_amount,expression:"repay_sum_amount",modifiers:{number:!0}}],staticClass:"input-box",attrs:{type:"number"},domProps:{value:t.repay_sum_amount},on:{change:t.changeNum,input:function(e){e.target.composing||(t.repay_sum_amount=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),t._e(),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("消费类型")]),i("span",{staticClass:"rt"},[i("span",{staticClass:"input-box",attrs:{type:"text"},on:{click:function(e){t.showPicker=!0}}},[t._v(t._s(t.repay_type))]),i("van-icon",{attrs:{name:"arrow"}})],1)]),i("van-popup",{attrs:{position:"bottom"},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[i("van-picker",{attrs:{"show-toolbar":"",columns:t.columns},on:{cancel:function(e){t.showPicker=!1},confirm:t.onConfirm}})],1),i("li",{staticClass:"clear item",on:{click:t.showDateSelectFun}},[i("span",{staticClass:"lt text"},[t._v("选择账单日期")]),i("van-icon",{staticClass:"rt",attrs:{name:"arrow"}}),t.dates.length>0?i("span",{staticClass:"rt repay-dates textEllipsis"},t._l(t.dates,(function(e,a){return i("span",{key:a,staticClass:"text"},[t._v(t._s(e.getDate())+", ")])})),0):t._e()],1),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("每天还款笔数")]),i("span",{staticClass:"calc-box rt"},[i("img",{staticClass:"img-btn",attrs:{src:a("ffeb")},on:{click:function(e){t.value>1?t.value--:t.value=1}}}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"input",attrs:{type:"text",readonly:"readonly"},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}}),i("img",{staticClass:"img-btn",attrs:{src:a("4bea")},on:{click:function(e){t.value<t.repay_type_list.length?t.value++:t.value=t.repay_type_list.length}}})])]),i("li",{staticClass:"clear item",on:{click:function(e){t.showSelectAddress=!0}}},[i("span",{staticClass:"lt text"},[t._v("选择省市")]),i("van-icon",{staticClass:"rt",attrs:{name:"arrow"}}),i("span",{staticClass:"rt text"},[t._v(t._s(t.selectedAreaList.all))])],1)],1),i("div",{staticClass:"add-btn flex-vertical-centering",on:{click:t.addBill}},[t._m(0)]),t.billList.length>0?i("div",{staticClass:"msg-box"},[i("div",{staticClass:"situation"},[i("div",{staticClass:"reset-btn",on:{click:t.toResetFun}},[i("div",{staticClass:"text"},[t._v("\n          账单\n        ")]),i("div",{staticClass:"text"},[t._v("\n          重置\n        ")])]),i("div",{staticClass:"item"},[i("div",{staticClass:"clear title"},[i("span",{staticClass:"lt text"},[t._v("定制时间："+t._s(t._f("timeToFormatDay")(t.billMsg.time)))]),i("span",{staticClass:"rt text"},[t._v("共"+t._s(t.billMsg.repayNum)+"笔")])]),i("div",{staticClass:"clear dec"},[i("span",{staticClass:"lt text"},[t._v("账单总金额：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.order_total_money)+"元")])]),i("span",{staticClass:"rt text"},[t._v("手续费：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.service_fee)+"元")])])]),i("div",{staticClass:"clear dec"},[i("span",{staticClass:"lt text"},[t._v("费率：\n            "),i("span",{staticClass:"price"},[t._v(t._s((100*t.billMsg.consume_rate).toFixed(2))+"%，"+t._s((100*t.billMsg.big_money_user_rate).toFixed(2))+"%")])]),i("span",{staticClass:"rt text"},[t._v(t._s(t.refundName)+"：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.fee_refund_money)+"元")])])]),i("div",{staticClass:"clear remaining"},[i("span",{staticClass:"lt text"},[t._v("提醒：本次计划信用卡余额不少于：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.marginAmount)+"元")])])])])]),i("ul",{staticClass:"list"},t._l(t.billList,(function(e,s){return i("li",{key:s,staticClass:"item"},[i("div",{staticClass:"title clear"},[i("span",{staticClass:"lt text"},[i("img",{attrs:{src:a("ad29")}}),t._v("\n            账单¥"+t._s(e.plan_bill_info&&e.plan_bill_info.amount)+"\n          ")]),i("span",{staticClass:"rt date"},[t._v(t._s(t._f("timeToFormatDay")(e.json_execute_time)))])]),i("ul",{staticClass:"item-list"},t._l(e.consume_bills,(function(e,a){return i("li",{key:a,staticClass:"list-item clear"},[i("span",{staticClass:"lt text"},[t._v("消费（¥"+t._s(e.plan_bill_info&&e.plan_bill_info.amount)+"）")]),i("span",{staticClass:"lt text",staticStyle:{"padding-left":"20px"}},[t._v(t._s(t.refundName)+"（¥"+t._s(e.plan_bill_info&&e.plan_bill_info.fee_refund_money)+"）")]),i("span",{staticClass:"rt",staticStyle:{"padding-left":"5px"},on:{click:function(i){return t.editTime(e.json_execute_time,s,a)}}},[t._v("编辑")]),i("span",{staticClass:"rt text"},[t._v(t._s(t._f("timeToFormatTime")(e.json_execute_time)))])])})),0)])})),0)]):t._e(),t.billList.length>0?i("div",{staticClass:"bottom-add-btn"},[i("span",{staticClass:"btn",on:{click:t.submit}},[t._v("提交账单")])]):t._e(),i("van-popup",{staticClass:"date-select",attrs:{position:"bottom"},model:{value:t.showTimeSelect,callback:function(e){t.showTimeSelect=e},expression:"showTimeSelect"}},[i("div",{staticClass:"title"},[t._v("\n      请自定义消费时间\n    ")]),i("ul",{staticClass:"top-list"},[i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("时")]),i("span",{staticClass:"rt"},[i("van-stepper",{attrs:{min:"0",max:"23"},model:{value:t.hour,callback:function(e){t.hour=e},expression:"hour"}})],1)]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("分")]),i("span",{staticClass:"rt"},[i("van-stepper",{attrs:{min:"0",max:"59"},model:{value:t.minute,callback:function(e){t.minute=e},expression:"minute"}})],1)]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("秒")]),i("span",{staticClass:"rt"},[i("van-stepper",{attrs:{min:"0",max:"59"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)])]),i("div",{staticClass:"confirm-btn",on:{click:t.closeTime}},[t._v("\n      确定\n    ")])]),i("select-card",{attrs:{"show-select-card":t.showSelectCard,"hide-select-card":t.hideSelectCardFun,"show-add-card-flag":t.showAddCardFlag,"current-nav":1},on:{selectedCard:t.selectedCardFun,showAddCard:t.showAddCardFun}}),i("select-card",{attrs:{"show-select-card":t.showSelectDepositCard,"hide-select-card":t.hideSelectDepositCardFun,"show-add-card-flag":t.showAddDepositCardFlag,"current-nav":0},on:{selectedCard:t.selectedDepositCardFun,showAddCard:t.showAddDepositCardFun}}),i("van-popup",{staticClass:"date-select",attrs:{position:"bottom"},model:{value:t.showDateSelect,callback:function(e){t.showDateSelect=e},expression:"showDateSelect"}},[i("div",{staticClass:"title"},[t._v("\n      请选择到期日期\n    ")]),i("v-date-picker",{staticClass:"date-picker",attrs:{"title-position":"center",mode:"multiple","is-required":!0,"min-date":t.minDate,"max-date":t.maxDate,"is-inline":!0,"disabled-attribute":{contentStyle:{color:"#999999"}},"select-attribute":{highlight:{color:"#000",backgroundColor:"#999999"}}},model:{value:t.dates,callback:function(e){t.dates=e},expression:"dates"}}),i("div",{staticClass:"confirm-btn",on:{click:t.getDate}},[t._v("\n      确定\n    ")])],1),i("van-popup",{staticClass:"picker",attrs:{position:"bottom"},model:{value:t.showSelectAddress,callback:function(e){t.showSelectAddress=e},expression:"showSelectAddress"}},[i("van-area",{attrs:{"area-list":t.areaList,"columns-num":2,title:"选择地址"},on:{confirm:function(e){return t.determine(e)},cancel:t.cancel}})],1),i("confirm-bill",{attrs:{"bank-card-id":t.bankMsg.id,"min-date":t.fromDate,"max-date":t.endDate,"show-confirm-bill":t.showConfirmBill,"to-hide-confirm-bill":t.hideConfirmBillFun,"to-show-confirm-bill":t.showConfirmBillFun,"from-intelligence-page":!0,"check-bill-list":t.billMsg,"confirm-msg-list":t.billList,"c-rate":t.z_user_rate,"list-data":t.ReplayBillModifyReq}}),t.isbindCard?i("div",{staticClass:"add-page"},[t.isbindCardhk?t._e():[i("bind-card",{attrs:{"from-intelligence-page":!0,"hide-bind-card":t.hideBindCardFun,"c-id":t.bankMsg.id,"c-code":t.channel_code},on:{toSuccess:t.showConfirmBillFun}})],t.isbindCardhk?[i("bind-cardh",{attrs:{"from-intelligence-page":!0,"hide-bind-card":t.hideBindCardFun,"c-id":t.bankMsg.id,"c-code":t.channel_code},on:{toSuccess:t.showConfirmBillFun}})]:t._e()],2):t._e()],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex-row-center"},[a("i",{staticClass:"iconfont icon-jia"}),a("span",[t._v("制定账单")])])}],n=a("a34a"),o=a.n(n),r=(a("e7e5"),a("d399")),l=a("dd6f"),c=a("494e"),d=a("3462"),u=a("c466"),h=a("2c92"),p=a("f933"),m=a("2626");function _(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?_(Object(a),!0).forEach((function(e){g(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function g(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function b(t,e,a,i,s,n,o){try{var r=t[n](o),l=r.value}catch(c){return void a(c)}r.done?e(l):Promise.resolve(l).then(i,s)}function C(t){return function(){var e=this,a=arguments;return new Promise((function(i,s){var n=t.apply(e,a);function o(t){b(n,i,s,o,r,"next",t)}function r(t){b(n,i,s,o,r,"throw",t)}o(void 0)}))}}var v={name:"Intelligence",components:{selectCard:l["a"],confirmBill:d["a"],topMsg:h["a"],bindCard:p["default"],bindCardh:m["a"]},filters:{timeToFormatDay:u["c"],timeToFormatDate:u["b"],timeToFormatTime:u["d"]},data:function(){return{showTimeSelect:!1,Times:"",date:"",hour:"",minute:"",time:"",index:"",i:"",timestamp:"",ReplayBillModifyReq:[],isbindCard:!1,isbindCardhk:!1,showSelectDepositCard:!1,showAddDepositCardFlag:!1,showSelectCard:!1,showDateSelect:!1,dates:[],repay_days:[],maxDate:new Date((new Date).setDate(31)),minDate:new Date((new Date).setDate(1)),currentDate:new Date,currentValue:new Date,value:1,reapyType:1,principal_amount:"",repayCountPerDay:1,repay_type:"1消1还",columns:["1消1还","2消1还","3消1还"],repay_type_list:[1,2,3],showPicker:!1,repay_sum_amount:"",showSelectAddress:!1,areaList:{},selectedAreaList:{},showConfirmBill:!1,bankMsg:{},repayConstraint:{},billList:[],refundName:"智慧金",billMsg:{time:"",service_fee:"",usePrice:"",repayPrice:"",useNum:0,repayNum:0,consume_rate:"",repay_service_fee:"",json_trade_no:"",fee_refund_money:"",order_total_money:""},channel_code:this.$route.query.code,z_user_rate:this.$route.query.z_user_rate||"",cardId:"",cardType:"CREDIT",cardId1:"",cardType1:"DEBIT",showAddCardFlag:!1,min_count:null,max_count:null}},computed:{cityRecord:{get:function(){return JSON.parse(localStorage.getItem("intelligenceArea"))},set:function(t){localStorage.setItem("intelligenceArea",JSON.stringify(t))}},fromDate:function(){return this.repay_days.length>0?new Date(this.repay_days[0]):new Date},endDate:function(){return this.repay_days.length>0?new Date(this.repay_days[this.repay_days.length-1]):new Date}},watch:{dates:function(t,e){this.repay_days=[];var a=!0,i=!1,s=void 0;try{for(var n,o=t[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var r=n.value;this.repay_days.push(r.getTime())}}catch(l){i=!0,s=l}finally{try{a||null==o.return||o.return()}finally{if(i)throw s}}},billList:function(t,e){var a=0,i=0,s=!0,n=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(s=(r=l.next()).done);s=!0){var c=r.value;a+=parseFloat(c.plan_bill_info.amount);var d=!0,u=!1,h=void 0;try{for(var p,m=c.consume_bills[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var _=p.value;i+=parseFloat(_.plan_bill_info.amount)}}catch(f){u=!0,h=f}finally{try{d||null==m.return||m.return()}finally{if(u)throw h}}}}catch(f){n=!0,o=f}finally{try{s||null==l.return||l.return()}finally{if(n)throw o}}this.billMsg.repayPrice=a.toFixed(2),this.billMsg.usePrice=i.toFixed(2)}},beforeRouteLeave:function(t,e,a){this.showAddCardFlag?(this.showAddCardFlag=!1,a(!1)):this.showAddDepositCardFlag?(this.showAddDepositCardFlag=!1,a(!1)):this.isbindCard?(this.isbindCard=!1,a(!1)):a()},created:function(){document.title="智能账单",this.areaList=c["a"],this.getRepayConstraint(),this.cityRecord&&(this.selectedAreaList=this.cityRecord),this.getRepayCount()},methods:{onConfirm:function(t){this.repay_type=t,"1消1还"==this.repay_type&&(this.reapyType=1),"2消1还"==this.repay_type&&(this.reapyType=2),"3消1还"==this.repay_type&&(this.reapyType=3),this.getRepayCount(),this.showPicker=!1},changeNum:function(){this.repay_sum_amount&&(this.principal_amount=.1*parseInt(this.repay_sum_amount),console.log(this.repay_sum_amount))},bbbindChannelCard:function(t,e,a){var i=this,s=this;s.$api.card.bbbindChannelCard(t,e,a).then((function(t){console.log("查询渠道绑卡状态成功"),console.log(t.data.data.data.signature);var e=t.data.data.data.signature,a=t.data.data.data.signType;2!=e?(i.isbindCard=!0,3==a&&(i.isbindCardhk=!0)):i.showConfirmBill=!0})).catch((function(t){console.log(t),Object(r["a"])("服务异常")}))},getCodeFun:function(t,e){var a=this;a.$api.card.bindChannelCard("CREDIT",t,e).then((function(t){console.log(t.data.data.state);var e=t.data.data.html;e&&a.$router.push({path:"/iframe",query:{url:e,title:"签约"}})})).catch((function(t){console.log(t)}))},registjudge:function(t){var e=this,a=this;a.$api.card.registjudge(t).then((function(t){console.log(t.data.data.state);var i=t.data.data.state;4!=i?a.showSelectDepositCard=!0:a.bbbindChannelCard(e.channel_code,e.cardId,e.cardType)})).catch((function(t){console.log(t)}))},getCardListFun:function(){},registrationChannels:function(t){var e=this,a={channel_code:e.channel_code,credit_card_id:e.bankMsg.id,debit_card_id:t};e.$api.card.registrationChannels(a).then((function(t){console.log("注册渠道信息"),console.log(a),console.log(t),"200000"===t.data.code&&(e.showConfirmBill=!0)})).catch((function(t){console.log(t);var a=t.data;"921006"!==a.code&&"921010"!==a.code||(e.isbindCard=!0)}))},hideSelectDepositCardFun:function(){this.showSelectDepositCard=!1},selectedDepositCardFun:function(t){var e=this,a=this;console.log("选择的储蓄卡"),console.log(t),a.depositbankMsg=t,a.cardId1=this.depositbankMsg.id,console.log(a.cardId1),a.$api.card.regchannel(a.cardType1,a.cardId1,a.channel_code).then((function(t){console.log(t.data.data.isSign),console.log(t.data.data.state);var i=t.data.data.isSign,s=t.data.data.state;console.log(i),console.log(s),"t"==i&&"000"==s&&(console.log("签约"),a.bbbindChannelCard(e.channel_code,e.cardId,e.cardType))})).catch((function(t){console.log(t),Object(r["a"])("储蓄卡注册失败")}))},showAddDepositCardFun:function(t){this.showAddDepositCardFlag=t},hideBindCardFun:function(){this.isbindCard=!1},showAddCardFun:function(t){this.showAddCardFlag=t},editTime:function(t,e,a){console.warn(t),this.datetime=t,this.timestamp=t,this.date=Object(u["c"])(t),Object(u["d"])(t);this.billList[e].consume_bills[a].json_execute_time;var i=Object(u["d"])(t).split(":");this.hour=i[0],this.minute=i[1],this.time=i[2],this.showTimeSelect=!0,this.index=e,this.i=a},closeTime:function(){parseInt(this.hour)<10&&(this.hour="0"+this.hour),parseInt(this.minute)<10&&(this.minute="0"+this.minute),parseInt(this.time)<10&&(this.time="0"+this.time);var t=this.hour+":"+this.minute+":"+this.time,e=this.date.replace(/-/g,"/")+" "+t;console.log(e);var a=Date.parse(new Date(e));console.log(a),this.billList[this.index].consume_bills[this.i].json_execute_time=a,this.showTimeSelect=!1},getRefundName:function(){this.$api.plan.getRefundName(null).then((function(t){})).catch((function(t){console.log(t),Object(r["a"])("服务异常")}))},getRepayCount:function(){var t=this;this.$api.plan.getRepayCount({repay_type:this.reapyType}).then((function(e){console.warn("每天还款笔数获取.."),console.warn(e),t.repay_type_list=e.data.data.repay_type_list,t.value=1,console.warn(t.repay_type_list)})).catch((function(t){console.warn(t)}))},getRepayConstraint:function(){},toResetFun:function(){var t=this;this.$dialog({title:"提示",message:"是否要重置账单？",confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.resetFun()}))},resetFun:function(){this.billMsg={time:"",service_fee:"",usePrice:"",repayPrice:"",useNum:0,repayNum:0,consume_rate:"",repay_service_fee:"",fee_refund_money:"",order_total_money:""},this.billList=[]},addBill:function(){var t=this;return/(^[1-9]\d*$)/.test(this.repay_sum_amount)?0===this.billList.length?(this.toAddBill(),!1):void this.$dialog({title:"提示",message:"是否要重置账单？",confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.toAddBill()})):(this.$dialog({title:"温馨提示",message:"账单总金额需取整数，请重新输入账单总金额",confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){})),!1)},toAddBill:function(){var t=C(o.a.mark((function t(){var e,a=this;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e={bank_card_id:this.bankMsg.id,channel_code:this.channel_code,city_code:this.selectedAreaList.region,repay_days:this.repay_days,repay_sum_amount:100*this.repay_sum_amount,repay_count_per_day:this.value,repay_type:this.reapyType},e.bank_card_id){t.next=6;break}return this.$toast.fail("请选择银行卡"),t.abrupt("return",!1);case 6:if(e.city_code){t.next=11;break}return this.$toast.fail("请选择城市"),t.abrupt("return",!1);case 11:if(0!==e.repay_days.length){t.next=16;break}return this.$toast.fail("请选择到期日"),t.abrupt("return",!1);case 16:if(e.repay_sum_amount){t.next=19;break}return this.$toast.fail("请输入账单金额"),t.abrupt("return",!1);case 19:return t.next=21,this.$api.plan.repayChannelConstraint(100*this.repay_sum_amount,this.channel_code).then((function(t){console.log(t),a.min_count=t.data.data.min_count,a.max_count=t.data.data.max_count}));case 21:if(0!==this.max_count||0!==this.min_count){t.next=26;break}return this.$toast("账单金额过小"),t.abrupt("return",!1);case 26:if(!(e.repay_sum_count>this.max_count)){t.next=29;break}t.next=32;break;case 29:if(!(e.repay_sum_count<this.min_count)){t.next=32;break}return this.$toast("最小账单笔数不小于"+this.min_count+"笔"),t.abrupt("return",!1);case 32:this.$api.plan.genIntelligent(e).then((function(t){var e=[];if("200000"===t.data.code){console.log("智能生成代还计划"),console.log(t.data.data),a.z_user_rate=t.data.data.plan_info.repay_plan_info.big_money_user_rate,a.billMsg.time=t.data.data.plan_info.create_time,a.billMsg.useNum=parseInt(t.data.data.consume_count),a.billMsg.repayNum=parseInt(t.data.data.repay_count),a.billMsg.service_fee=t.data.data.service_fee,a.billMsg.marginAmount=t.data.data.margin_amount,a.billMsg.big_money_user_rate=t.data.data.plan_info.repay_plan_info.big_money_user_rate,a.billMsg.consume_rate=t.data.data.plan_info.repay_plan_info.consume_rate,a.billMsg.repay_service_fee=t.data.data.plan_info.repay_plan_info.repay_service_fee,a.billMsg.repayFee=t.data.data.plan_info.repay_plan_info.repay_fee,a.billMsg.fee_refund_money=t.data.data.plan_info.repay_plan_info.fee_refund_money,a.billMsg.json_trade_no=t.data.data.plan_info.json_trade_no,a.billMsg.order_total_money=t.data.data.plan_info.repay_plan_info.order_total_money;var i=!0,s=!1,n=void 0;try{for(var o,r=t.data.data.bills[Symbol.iterator]();!(i=(o=r.next()).done);i=!0){var l=o.value;e.push(l)}}catch(d){s=!0,n=d}finally{try{i||null==r.return||r.return()}finally{if(s)throw n}}a.billList=e;var c=t.data.data.delay_msg;c&&a.$dialog({title:"温馨提示",message:c,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){}))}else a.$toast(t.data.msg)}));case 33:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),showDateSelectFun:function(){if(0===Object.keys(this.bankMsg).length&&this.bankMsg.constructor===Object)return this.$toast("请先选择银行卡"),!1;this.showDateSelect=!0},cityChoice:function(){this.show=!0},determine:function(t){var e={};e.all=t[0].name+" "+t[1].name,e.province=t[0].name,e.city=t[1].name,e.region=t[1].code,Object.assign(this.selectedAreaList,e),this.showSelectAddress=!1,this.cityRecord=this.selectedAreaList},cancel:function(){this.showSelectAddress=!1},hideSelectCardFun:function(){this.showSelectCard=!1},getDate:function(){this.showDateSelect=!1},submit:function(){for(var t=[],e=0;e<this.billList.length;e++)for(var a=0;a<this.billList[e].consume_bills.length;a++){var i=this.billList[e].consume_bills[a].json_execute_time,s=this.billList[e].consume_bills[a].json_bill_no;t.push({plan_executed_time:i,bill_no:s})}console.log(t),this.ReplayBillModifyReq=t,this.registjudge(this.channel_code)},hideConfirmBillFun:function(){this.showConfirmBill=!1},showConfirmBillFun:function(){this.showConfirmBill=!0},judeRange:function(t,e){var a=parseInt(t),i=parseInt(e),s=new Date,n=s,o=s.getDate(),r=s.getMonth(),l=0;l=r<11?r+1:0,a<i?(o>=i&&(this.minDate=new Date(n.setMonth(r+1,a)),this.maxDate=new Date(n.setMonth(l,i-1))),o<=a&&(this.minDate=new Date(n.setMonth(r,a)),this.maxDate=new Date(n.setMonth(r,i-1))),o>a&&o<i&&(this.minDate=new Date(n.setMonth(r,o)),this.maxDate=new Date(n.setMonth(r,i-1)))):a>i&&(o>=e&&o>=a&&(this.minDate=new Date(n.setMonth(r,o)),this.maxDate=new Date(n.setMonth(r+1,i-1))),o>e&&o<a&&(this.minDate=new Date(n.setMonth(r,a)),this.maxDate=new Date(n.setMonth(r+1,i-1))),o<e&&(this.minDate=new Date(n.setMonth(r,o)),this.maxDate=new Date(n.setMonth(r,i-1)))),this.currentValue=this.minDate},selectedCardFun:function(t){var e=this;console.log("选择银行卡...."),console.log(t),this.bankMsg=t,this.bankMsg.card_no=this.bankMsg.card_info.card_no.substr(-4,4),this.cardId=t.id,this.$api.card.getCard("CREDIT",this.bankMsg.id).then((function(t){console.log("获取信用卡"),console.log(t);var a={id:t.data.data.id,card_info:f({},t.data.data),bank_info:t.data.data.bank_info};e.$store.commit("SET_CURRENT_CREDIT_CARD",a)})),this.judeRange(t.card_info.bill_date,t.card_info.repayment_date),this.dates=[],this.resetFun()}}},y=v,w=(a("9442"),a("2877")),x=Object(w["a"])(y,i,s,!1,null,"2a485402",null);e["default"]=x.exports},9442:function(t,e,a){"use strict";var i=a("0e52"),s=a.n(i);s.a},"9c90":function(t,e,a){},ac9c:function(t,e,a){"use strict";var i=a("2a26"),s=a.n(i);s.a},ad29:function(t,e){t.exports="data:image/png;base64,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"},d2d7:function(t,e,a){"use strict";var i=a("9c90"),s=a.n(i);s.a},e3ee:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAA4CAYAAAB3yEEBAAACvklEQVRYR82Zv2sVQRSFvwjBwtLKIp3/gLWNYoKoCaKNiIWNNiFdxB9gYTpj7CzstBIEJSAWIkpAEdKksLFIYSFYCEIgiBIRk3BkRoZHdubOvpl9e8vHvJ1v58zcc+fuGKOJ48BtYAb45RHGRsAyDSwD48AH4KQH6hrmMvAI2BcsgoCmgK0uYa4Diw1KrABnuoJZAq4ltsRybRjJIVkkTyw2gVM1YfYDzwFt2Fh8A44B67VgDgCvgaMJkM8O5KvG1YA5CLwBjiRA1tyx3qiVZyYAnYzDCZC3LuFtheNKrowA3gOHEiDPgIvA38FxpWAkiaSRRLG4B9xoGlACRj7zEtCmjcUs8DA2YFiY0Gea5pEckkXyRGMYmL18ZnAyOfJZQBs2GW1hpPvdxNN1ZE8AH5MUbkAbmAfAXGICJTFlVSU1c+TAWH3mEzAJKM1nhRXG6jOrLqv+yKLIkMnqM6+Ac8DvNiD6T2plrD6jMuEqsN0WJAVj9ZkF4M4wEP6/TStj8Zkd4Iornkqw7CmTxWe0Ly4AL4pQNGxgi8/opOh6oZNTNEKZzgNP3X2maZLvgICVS4qHh5HPPE6cLmVTpfcvxSkCmXSF0FUiFvIXgfwvEWsAaWV6BaOXtJQDncjkV9xSKHWygT1Qb462B+pN0vNAvbEDD9Qbo/RAOSWETFPm2TpS9YwebC2uZJoyz2rFlX/L3pSdHiinIFeKUE7KCotMgw+0XFVkpvKyaleVECrWLPTjOrnE+cksfqbr7WngnUWvNjKFz7X42R/gUu2Lf46faWz1lkiOn2msmtI3myQbVqbwuRY/0/gnrn6q1kbL9bPqDcZcP1PrVd0Kdcf/RUmZQsmsfrbugKo1pXP9rHq7PtfPJNVkLZkGT+99YD6Rhat/4gnnjzUlO/34FfOzkXwW9EC9+WAa+tkt1wP86X/cBQn4mhB2t026AAAAAElFTkSuQmCC"},e8ec:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"intelligence-page"},[i("top-msg",{attrs:{"header-name":"添加懒人计划"}}),i("ul",{staticClass:"top-list"},[i("li",{staticClass:"clear item",on:{click:function(e){t.showSelectCard=!0}}},[i("span",{staticClass:"lt text"},[t._v("选择信用卡")]),i("span",{staticClass:"rt intro"},[t._v("\n        "+t._s(t.bankMsg.bank_info&&t.bankMsg.bank_info.name)+t._s(0===Object.keys(t.bankMsg).length&&t.bankMsg.constructor===Object?"":"（尾号")+t._s(t.bankMsg&&t.bankMsg.card_no)+t._s(0===Object.keys(t.bankMsg).length&&t.bankMsg.constructor===Object?"":"）")+"\n        "),i("van-icon",{attrs:{name:"arrow"}})],1)]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("还款总金额")]),i("span",{staticClass:"rt"},[i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.repay_sum_amount,expression:"repay_sum_amount",modifiers:{number:!0}}],staticClass:"input-box",attrs:{type:"number"},domProps:{value:t.repay_sum_amount},on:{change:t.changeNum,input:function(e){e.target.composing||(t.repay_sum_amount=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("信用卡预留金额")]),i("span",{staticClass:"rt"},[i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.principal_amount,expression:"principal_amount",modifiers:{number:!0}}],staticClass:"input-box",attrs:{type:"number"},domProps:{value:t.principal_amount},on:{input:function(e){e.target.composing||(t.principal_amount=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("消费类型")]),i("span",{staticClass:"rt"},[i("span",{staticClass:"input-box",attrs:{type:"text"},on:{click:function(e){t.showPicker=!0}}},[t._v(t._s(t.repay_type))]),i("van-icon",{attrs:{name:"arrow"}})],1)]),i("van-popup",{attrs:{position:"bottom"},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[i("van-picker",{attrs:{"show-toolbar":"",columns:t.columns},on:{cancel:function(e){t.showPicker=!1},confirm:t.onConfirm}})],1),t._e(),i("li",{staticClass:"clear item",staticStyle:{display:"none"}},[i("span",{staticClass:"lt text"},[t._v("每天还款笔数")]),i("span",{staticClass:"calc-box rt"},[i("img",{staticClass:"img-btn",attrs:{src:a("ffeb")},on:{click:function(e){t.value>1?t.value--:t.value=1}}}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"input",attrs:{type:"text",readonly:"readonly"},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}}),i("img",{staticClass:"img-btn",attrs:{src:a("4bea")},on:{click:function(e){t.value<t.repay_type_list.length?t.value++:t.value=t.repay_type_list.length}}})])]),i("li",{staticClass:"clear item",on:{click:function(e){t.showSelectAddress=!0}}},[i("span",{staticClass:"lt text"},[t._v("选择省市")]),i("van-icon",{staticClass:"rt",attrs:{name:"arrow"}}),i("span",{staticClass:"rt text"},[t._v(t._s(t.selectedAreaList.all))])],1)],1),i("div",{staticClass:"add-btn flex-vertical-centering",on:{click:t.addBill}},[t._m(0)]),t.billList.length>0?i("div",{staticClass:"msg-box"},[i("div",{staticClass:"situation"},[i("div",{staticClass:"reset-btn",on:{click:t.toResetFun}},[i("div",{staticClass:"text"},[t._v("\n          账单\n        ")]),i("div",{staticClass:"text"},[t._v("\n          重置\n        ")])]),i("div",{staticClass:"item"},[i("div",{staticClass:"clear title"},[i("span",{staticClass:"lt text"},[t._v("定制时间："+t._s(t._f("timeToFormatDay")(t.billMsg.time)))]),i("span",{staticClass:"rt text"},[t._v("共"+t._s(t.billMsg.repayNum)+"笔")])]),i("div",{staticClass:"clear dec"},[i("span",{staticClass:"lt text"},[t._v("账单总金额：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.order_total_money)+"元")])]),i("span",{staticClass:"rt text"},[t._v("手续费：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.service_fee)+"元")])])]),i("div",{staticClass:"clear dec"},[i("span",{staticClass:"lt text"},[t._v("费率：\n            "),i("span",{staticClass:"price"},[t._v(t._s((100*t.billMsg.consume_rate).toFixed(2))+"%，"+t._s((100*t.billMsg.big_money_user_rate).toFixed(2))+"%")])]),i("span",{staticClass:"rt text"},[t._v(t._s(t.refundName)+"：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.fee_refund_money)+"元")])])]),i("div",{staticClass:"clear remaining"},[i("span",{staticClass:"lt text"},[t._v("提醒：本次计划信用卡余额不少于：\n            "),i("span",{staticClass:"price"},[t._v(t._s(t.billMsg.marginAmount)+"元")])])])])]),i("ul",{staticClass:"list"},t._l(t.billList,(function(e,s){return i("li",{key:s,staticClass:"item"},[i("div",{staticClass:"title clear"},[i("span",{staticClass:"lt text"},[i("img",{attrs:{src:a("ad29")}}),t._v("\n            账单¥"+t._s(e.plan_bill_info&&e.plan_bill_info.amount)+"\n          ")]),i("span",{staticClass:"rt date"},[t._v(t._s(t._f("timeToFormatDay")(e.json_execute_time)))])]),i("ul",{staticClass:"item-list"},t._l(e.consume_bills,(function(e,a){return i("li",{key:a,staticClass:"list-item clear"},[i("span",{staticClass:"lt text"},[t._v("消费（¥"+t._s(e.plan_bill_info&&e.plan_bill_info.amount)+"）")]),i("span",{staticClass:"lt text",staticStyle:{"padding-left":"20px"}},[t._v(t._s(t.refundName)+"（¥"+t._s(e.plan_bill_info&&e.plan_bill_info.fee_refund_money)+"）")]),i("span",{staticClass:"rt",staticStyle:{"padding-left":"5px"},on:{click:function(i){return t.editTime(e.json_execute_time,s,a)}}},[t._v("编辑")]),i("span",{staticClass:"rt text"},[t._v(t._s(t._f("timeToFormatTime")(e.json_execute_time)))])])})),0)])})),0)]):t._e(),t.billList.length>0?i("div",{staticClass:"bottom-add-btn"},[i("span",{staticClass:"btn",on:{click:t.submit}},[t._v("提交账单")])]):t._e(),i("van-popup",{staticClass:"date-select",attrs:{position:"bottom"},model:{value:t.showTimeSelect,callback:function(e){t.showTimeSelect=e},expression:"showTimeSelect"}},[i("div",{staticClass:"title"},[t._v("\n      请自定义消费时间\n    ")]),i("ul",{staticClass:"top-list"},[i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("时")]),i("span",{staticClass:"rt"},[i("van-stepper",{attrs:{min:"0",max:"23"},model:{value:t.hour,callback:function(e){t.hour=e},expression:"hour"}})],1)]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("分")]),i("span",{staticClass:"rt"},[i("van-stepper",{attrs:{min:"0",max:"59"},model:{value:t.minute,callback:function(e){t.minute=e},expression:"minute"}})],1)]),i("li",{staticClass:"clear item"},[i("span",{staticClass:"lt text"},[t._v("秒")]),i("span",{staticClass:"rt"},[i("van-stepper",{attrs:{min:"0",max:"59"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)])]),i("div",{staticClass:"confirm-btn",on:{click:t.closeTime}},[t._v("\n      确定\n    ")])]),i("select-card",{attrs:{"show-select-card":t.showSelectCard,"hide-select-card":t.hideSelectCardFun,"show-add-card-flag":t.showAddCardFlag,"current-nav":1},on:{selectedCard:t.selectedCardFun,showAddCard:t.showAddCardFun}}),i("select-card",{attrs:{"show-select-card":t.showSelectDepositCard,"hide-select-card":t.hideSelectDepositCardFun,"show-add-card-flag":t.showAddDepositCardFlag,"current-nav":0},on:{selectedCard:t.selectedDepositCardFun,showAddCard:t.showAddDepositCardFun}}),i("van-popup",{staticClass:"date-select",attrs:{position:"bottom"},model:{value:t.showDateSelect,callback:function(e){t.showDateSelect=e},expression:"showDateSelect"}},[i("div",{staticClass:"title"},[t._v("\n      请选择到期日期\n    ")]),i("v-date-picker",{staticClass:"date-picker",attrs:{"title-position":"center",mode:"multiple","is-required":!0,"min-date":t.minDate,"max-date":t.maxDate,"is-inline":!0,"disabled-attribute":{contentStyle:{color:"#999999"}},"select-attribute":{highlight:{color:"#000",backgroundColor:"#999999"}}},model:{value:t.dates,callback:function(e){t.dates=e},expression:"dates"}}),i("div",{staticClass:"confirm-btn",on:{click:t.getDate}},[t._v("\n      确定\n    ")])],1),i("van-popup",{staticClass:"picker",attrs:{position:"bottom"},model:{value:t.showSelectAddress,callback:function(e){t.showSelectAddress=e},expression:"showSelectAddress"}},[i("van-area",{attrs:{"area-list":t.areaList,"columns-num":2,title:"选择地址"},on:{confirm:function(e){return t.determine(e)},cancel:t.cancel}})],1),i("confirm-bill",{attrs:{"bank-card-id":t.bankMsg.id,"min-date":t.fromDate,"max-date":t.endDate,"show-confirm-bill":t.showConfirmBill,"to-hide-confirm-bill":t.hideConfirmBillFun,"to-show-confirm-bill":t.showConfirmBillFun,"from-intelligence-page":!0,"check-bill-list":t.billMsg,"confirm-msg-list":t.billList,"c-rate":t.z_user_rate,"list-data":t.ReplayBillModifyReq}}),t.isbindCard?i("div",{staticClass:"add-page"},[t.isbindCardhk?t._e():[i("bind-card",{attrs:{"from-intelligence-page":!0,"hide-bind-card":t.hideBindCardFun,"c-id":t.bankMsg.id,"c-code":t.channel_code},on:{toSuccess:t.showConfirmBillFun}})],t.isbindCardhk?[i("bind-cardh",{attrs:{"from-intelligence-page":!0,"hide-bind-card":t.hideBindCardFun,"c-id":t.bankMsg.id,"c-code":t.channel_code},on:{toSuccess:t.showConfirmBillFun}})]:t._e()],2):t._e()],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex-row-center"},[a("i",{staticClass:"iconfont icon-jia"}),a("span",[t._v("制定账单")])])}],n=a("a34a"),o=a.n(n),r=(a("e7e5"),a("d399")),l=a("dd6f"),c=a("494e"),d=a("3462"),u=a("c466"),h=a("2c92"),p=a("f933"),m=a("2626");function _(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?_(Object(a),!0).forEach((function(e){g(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function g(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function b(t,e,a,i,s,n,o){try{var r=t[n](o),l=r.value}catch(c){return void a(c)}r.done?e(l):Promise.resolve(l).then(i,s)}function C(t){return function(){var e=this,a=arguments;return new Promise((function(i,s){var n=t.apply(e,a);function o(t){b(n,i,s,o,r,"next",t)}function r(t){b(n,i,s,o,r,"throw",t)}o(void 0)}))}}var v={name:"Intelligence",components:{selectCard:l["a"],confirmBill:d["a"],topMsg:h["a"],bindCard:p["default"],bindCardh:m["a"]},filters:{timeToFormatDay:u["c"],timeToFormatDate:u["b"],timeToFormatTime:u["d"]},data:function(){return{showTimeSelect:!1,Times:"",date:"",hour:"",minute:"",time:"",index:"",i:"",timestamp:"",ReplayBillModifyReq:[],isbindCard:!1,isbindCardhk:!1,showSelectDepositCard:!1,showAddDepositCardFlag:!1,showSelectCard:!1,showDateSelect:!1,dates:[],repay_days:[],maxDate:new Date((new Date).setDate(31)),minDate:new Date((new Date).setDate(1)),currentDate:new Date,currentValue:new Date,value:2,reapyType:2,principal_amount:"",repayCountPerDay:1,repay_type:"2消1还",columns:["1消1还","2消1还","3消1还"],repay_type_list:[1,2,3],showPicker:!1,repay_sum_amount:"",showSelectAddress:!1,areaList:{},selectedAreaList:{},showConfirmBill:!1,bankMsg:{},repayConstraint:{},billList:[],refundName:"智慧金",billMsg:{time:"",service_fee:"",usePrice:"",repayPrice:"",useNum:0,repayNum:0,consume_rate:"",repay_service_fee:"",json_trade_no:"",fee_refund_money:"",order_total_money:""},channel_code:this.$route.query.code,z_user_rate:this.$route.query.z_user_rate||"",cardId:"",cardType:"CREDIT",cardId1:"",cardType1:"DEBIT",showAddCardFlag:!1,min_count:null,max_count:null}},computed:{cityRecord:{get:function(){return JSON.parse(localStorage.getItem("intelligenceArea"))},set:function(t){localStorage.setItem("intelligenceArea",JSON.stringify(t))}},fromDate:function(){return this.repay_days.length>0?new Date(this.repay_days[0]):new Date},endDate:function(){return this.repay_days.length>0?new Date(this.repay_days[this.repay_days.length-1]):new Date}},watch:{dates:function(t,e){this.repay_days=[];var a=!0,i=!1,s=void 0;try{for(var n,o=t[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var r=n.value;this.repay_days.push(r.getTime())}}catch(l){i=!0,s=l}finally{try{a||null==o.return||o.return()}finally{if(i)throw s}}},billList:function(t,e){var a=0,i=0,s=!0,n=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(s=(r=l.next()).done);s=!0){var c=r.value;a+=parseFloat(c.plan_bill_info.amount);var d=!0,u=!1,h=void 0;try{for(var p,m=c.consume_bills[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var _=p.value;i+=parseFloat(_.plan_bill_info.amount)}}catch(f){u=!0,h=f}finally{try{d||null==m.return||m.return()}finally{if(u)throw h}}}}catch(f){n=!0,o=f}finally{try{s||null==l.return||l.return()}finally{if(n)throw o}}this.billMsg.repayPrice=a.toFixed(2),this.billMsg.usePrice=i.toFixed(2)}},beforeRouteLeave:function(t,e,a){this.showAddCardFlag?(this.showAddCardFlag=!1,a(!1)):this.showAddDepositCardFlag?(this.showAddDepositCardFlag=!1,a(!1)):this.isbindCard?(this.isbindCard=!1,a(!1)):a()},created:function(){document.title="懒人计划",this.areaList=c["a"],this.getRepayConstraint(),this.cityRecord&&(this.selectedAreaList=this.cityRecord),this.getRepayCount()},methods:{onConfirm:function(t){this.repay_type=t,"1消1还"==this.repay_type&&(this.reapyType=1),"2消1还"==this.repay_type&&(this.reapyType=2),"3消1还"==this.repay_type&&(this.reapyType=3),this.getRepayCount(),this.showPicker=!1},changeNum:function(){this.repay_sum_amount&&(this.principal_amount=Math.floor(100*parseInt(this.repay_sum_amount)/1e3),console.log(this.repay_sum_amount))},bbbindChannelCard:function(t,e,a){var i=this,s=this;s.$api.card.bbbindChannelCard(t,e,a).then((function(t){console.log("查询渠道绑卡状态成功"),console.log(t.data.data.data.signature);var e=t.data.data.data.signature,a=t.data.data.data.signType;2!=e?(i.isbindCard=!0,3==a&&(i.isbindCardhk=!0)):i.showConfirmBill=!0})).catch((function(t){console.log(t),Object(r["a"])("服务异常")}))},getCodeFun:function(t,e){var a=this;a.$api.card.bindChannelCard("CREDIT",t,e).then((function(t){console.log(t.data.data.state);var e=t.data.data.html;e&&a.$router.push({path:"/iframe",query:{url:e,title:"签约"}})})).catch((function(t){console.log(t)}))},registjudge:function(t){var e=this,a=this;a.$api.card.registjudge(t).then((function(t){console.log(t.data.data.state);var i=t.data.data.state;4!=i?a.showSelectDepositCard=!0:a.bbbindChannelCard(e.channel_code,e.cardId,e.cardType)})).catch((function(t){console.log(t)}))},getCardListFun:function(){},registrationChannels:function(t){var e=this,a={channel_code:e.channel_code,credit_card_id:e.bankMsg.id,debit_card_id:t};e.$api.card.registrationChannels(a).then((function(t){console.log("注册渠道信息"),console.log(a),console.log(t),"200000"===t.data.code&&(e.showConfirmBill=!0)})).catch((function(t){console.log(t);var a=t.data;"921006"!==a.code&&"921010"!==a.code||(e.isbindCard=!0)}))},hideSelectDepositCardFun:function(){this.showSelectDepositCard=!1},selectedDepositCardFun:function(t){var e=this,a=this;console.log("选择的储蓄卡"),console.log(t),a.depositbankMsg=t,a.cardId1=this.depositbankMsg.id,console.log(a.cardId1),a.$api.card.regchannel(a.cardType1,a.cardId1,a.channel_code).then((function(t){console.log(t.data.data.isSign),console.log(t.data.data.state);var i=t.data.data.isSign,s=t.data.data.state;console.log(i),console.log(s),"t"==i&&"000"==s&&(console.log("签约"),a.bbbindChannelCard(e.channel_code,e.cardId,e.cardType))})).catch((function(t){console.log(t),Object(r["a"])("储蓄卡注册失败")}))},showAddDepositCardFun:function(t){this.showAddDepositCardFlag=t},hideBindCardFun:function(){this.isbindCard=!1},showAddCardFun:function(t){this.showAddCardFlag=t},editTime:function(t,e,a){console.warn(t),this.datetime=t,this.timestamp=t,this.date=Object(u["c"])(t),Object(u["d"])(t);this.billList[e].consume_bills[a].json_execute_time;var i=Object(u["d"])(t).split(":");this.hour=i[0],this.minute=i[1],this.time=i[2],this.showTimeSelect=!0,this.index=e,this.i=a},closeTime:function(){parseInt(this.hour)<10&&(this.hour="0"+this.hour),parseInt(this.minute)<10&&(this.minute="0"+this.minute),parseInt(this.time)<10&&(this.time="0"+this.time);var t=this.hour+":"+this.minute+":"+this.time,e=this.date.replace(/-/g,"/")+" "+t;console.log(e);var a=Date.parse(new Date(e));console.log(a),this.billList[this.index].consume_bills[this.i].json_execute_time=a,this.showTimeSelect=!1},getRefundName:function(){this.$api.plan.getRefundName(null).then((function(t){})).catch((function(t){console.log(t),Object(r["a"])("服务异常")}))},getRepayCount:function(){var t=this;this.$api.plan.getRepayCount({repay_type:this.reapyType}).then((function(e){console.warn("每天还款笔数获取.."),console.warn(e),t.repay_type_list=e.data.data.repay_type_list,t.value=2,console.warn(t.repay_type_list)})).catch((function(t){console.warn(t)}))},getRepayConstraint:function(){},toResetFun:function(){var t=this;this.$dialog({title:"提示",message:"是否要重置账单？",confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.resetFun()}))},resetFun:function(){this.billMsg={time:"",service_fee:"",usePrice:"",repayPrice:"",useNum:0,repayNum:0,consume_rate:"",repay_service_fee:"",fee_refund_money:"",order_total_money:""},this.billList=[]},addBill:function(){var t=this;return/(^[1-9]\d*$)/.test(this.repay_sum_amount)?0===this.billList.length?(this.toAddBill(),!1):void this.$dialog({title:"提示",message:"是否要重置账单？",confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.toAddBill()})):(this.$dialog({title:"温馨提示",message:"账单总金额需取整数，请重新输入账单总金额",confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){})),!1)},toAddBill:function(){var t=C(o.a.mark((function t(){var e,a=this;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e={bank_card_id:this.bankMsg.id,channel_code:this.channel_code,city_code:this.selectedAreaList.region,repay_sum_amount:100*this.repay_sum_amount,repay_count_per_day:this.value,repay_type:this.reapyType,principal_amount:100*this.principal_amount},e.bank_card_id){t.next=6;break}return this.$toast.fail("请选择银行卡"),t.abrupt("return",!1);case 6:if(e.city_code){t.next=11;break}return this.$toast.fail("请选择城市"),t.abrupt("return",!1);case 11:if(e.repay_sum_amount){t.next=16;break}return this.$toast.fail("请输入账单金额"),t.abrupt("return",!1);case 16:if(e.principal_amount){t.next=19;break}return this.$toast.fail("请输入信用卡预留金额"),t.abrupt("return",!1);case 19:return t.next=21,this.$api.plan.repayChannelConstraintV2(100*this.repay_sum_amount,this.channel_code,{repay_type:this.reapyType}).then((function(t){console.log(t),a.min_count=t.data.data.min_count,a.max_count=t.data.data.max_count}));case 21:if(0!==this.max_count||0!==this.min_count){t.next=26;break}return this.$toast("账单金额过小"),t.abrupt("return",!1);case 26:if(!(e.repay_sum_count>this.max_count)){t.next=29;break}t.next=32;break;case 29:if(!(e.repay_sum_count<this.min_count)){t.next=32;break}return this.$toast("最小账单笔数不小于"+this.min_count+"笔"),t.abrupt("return",!1);case 32:this.$api.plan.genIntelligentV2(e).then((function(t){var e=[];if("200000"===t.data.code){console.log("智能生成代还计划"),console.log(t.data.data),a.z_user_rate=t.data.data.plan_info.repay_plan_info.big_money_user_rate,a.billMsg.time=t.data.data.plan_info.create_time,a.billMsg.useNum=parseInt(t.data.data.consume_count),a.billMsg.repayNum=parseInt(t.data.data.repay_count),a.billMsg.service_fee=t.data.data.service_fee,a.billMsg.marginAmount=t.data.data.margin_amount,a.billMsg.big_money_user_rate=t.data.data.plan_info.repay_plan_info.big_money_user_rate,a.billMsg.consume_rate=t.data.data.plan_info.repay_plan_info.consume_rate,a.billMsg.repay_service_fee=t.data.data.plan_info.repay_plan_info.repay_service_fee,a.billMsg.repayFee=t.data.data.plan_info.repay_plan_info.repay_fee,a.billMsg.fee_refund_money=t.data.data.plan_info.repay_plan_info.fee_refund_money,a.billMsg.json_trade_no=t.data.data.plan_info.json_trade_no,a.billMsg.order_total_money=t.data.data.plan_info.repay_plan_info.order_total_money;var i=!0,s=!1,n=void 0;try{for(var o,r=t.data.data.bills[Symbol.iterator]();!(i=(o=r.next()).done);i=!0){var l=o.value;e.push(l)}}catch(d){s=!0,n=d}finally{try{i||null==r.return||r.return()}finally{if(s)throw n}}a.billList=e;var c=t.data.data.delay_msg;c&&a.$dialog({title:"温馨提示",message:c,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){}))}else a.$toast(t.data.msg)}));case 33:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),showDateSelectFun:function(){if(0===Object.keys(this.bankMsg).length&&this.bankMsg.constructor===Object)return this.$toast("请先选择银行卡"),!1;this.showDateSelect=!0},cityChoice:function(){this.show=!0},determine:function(t){var e={};e.all=t[0].name+" "+t[1].name,e.province=t[0].name,e.city=t[1].name,e.region=t[1].code,Object.assign(this.selectedAreaList,e),this.showSelectAddress=!1,this.cityRecord=this.selectedAreaList},cancel:function(){this.showSelectAddress=!1},hideSelectCardFun:function(){this.showSelectCard=!1},getDate:function(){this.showDateSelect=!1},submit:function(){for(var t=[],e=0;e<this.billList.length;e++)for(var a=0;a<this.billList[e].consume_bills.length;a++){var i=this.billList[e].consume_bills[a].json_execute_time,s=this.billList[e].consume_bills[a].json_bill_no;t.push({plan_executed_time:i,bill_no:s})}console.log(t),this.ReplayBillModifyReq=t,this.registjudge(this.channel_code)},hideConfirmBillFun:function(){this.showConfirmBill=!1},showConfirmBillFun:function(){this.showConfirmBill=!0},judeRange:function(t,e){var a=parseInt(t),i=parseInt(e),s=new Date,n=s,o=s.getDate(),r=s.getMonth(),l=0;l=r<11?r+1:0,a<i?(o>=i&&(this.minDate=new Date(n.setMonth(r+1,a)),this.maxDate=new Date(n.setMonth(l,i-1))),o<=a&&(this.minDate=new Date(n.setMonth(r,a)),this.maxDate=new Date(n.setMonth(r,i-1))),o>a&&o<i&&(this.minDate=new Date(n.setMonth(r,o)),this.maxDate=new Date(n.setMonth(r,i-1)))):a>i&&(o>=e&&o>=a&&(this.minDate=new Date(n.setMonth(r,o)),this.maxDate=new Date(n.setMonth(r+1,i-1))),o>e&&o<a&&(this.minDate=new Date(n.setMonth(r,a)),this.maxDate=new Date(n.setMonth(r+1,i-1))),o<e&&(this.minDate=new Date(n.setMonth(r,o)),this.maxDate=new Date(n.setMonth(r,i-1)))),this.currentValue=this.minDate},selectedCardFun:function(t){var e=this;console.log("选择银行卡...."),console.log(t),this.bankMsg=t,this.bankMsg.card_no=this.bankMsg.card_info.card_no.substr(-4,4),this.cardId=t.id,this.$api.card.getCard("CREDIT",this.bankMsg.id).then((function(t){console.log("获取信用卡"),console.log(t);var a={id:t.data.data.id,card_info:f({},t.data.data),bank_info:t.data.data.bank_info};e.$store.commit("SET_CURRENT_CREDIT_CARD",a)})),this.judeRange(t.card_info.bill_date,t.card_info.repayment_date),this.dates=[],this.resetFun()}}},y=v,w=(a("ac9c"),a("2877")),x=Object(w["a"])(y,i,s,!1,null,"4aed1324",null);e["default"]=x.exports},ffeb:function(t,e){t.exports="data:image/png;base64,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"}}]);