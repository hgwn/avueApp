(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["huabeiPay"],{"09e8":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"mgb100"},[i("top-msg",{attrs:{"header-name":"选择储蓄卡"}}),i("div",{staticClass:"con_body"},[i("div",{staticClass:"channel-desc"},[i("div",[i("div",{staticClass:"channel-desc-head"},[t._v("\r\n            当前通道：\r\n          ")]),i("div",{staticClass:"channel-desc-bottom"},[t._v("\r\n            "+t._s(t.channelName)+"\r\n          ")])]),i("div",[i("div",{staticClass:"channel-desc-head"},[t._v("\r\n            手续费 (元) ：￥"+t._s((t.wrapTotalAmount-t.wrapPaybackAmount-t.computeFee).toFixed(2))+"\r\n          ")]),i("div",{staticClass:"channel-desc-bottom"},[t._v("\r\n            结算费 (元/笔) ：￥"+t._s(t.computeFee)+"\r\n          ")])])]),i("div",{staticClass:"tongdaobg"},[i("div",{staticClass:"flex-vertical-centering tongdao"},[i("div",{staticClass:"pay-money-title"},[t._v("\r\n            付款金额 (元)\r\n          ")]),i("p",{staticClass:"colorfff"},[t._v("\r\n            "+t._s(t.wrapTotalAmount)+"\r\n          ")]),i("i",{staticClass:"iconfont icon-xia xia"}),i("div",{staticClass:"pay-money-title"},[t._v("\r\n            实际到账金额 (元)\r\n          ")]),i("p",{staticClass:"colorfff"},[t._v("\r\n            "+t._s(t.wrapPaybackAmount)+"\r\n          ")])])]),i("div",{staticClass:"select_content"},[i("div",{staticClass:"select_make"},[t.chooseCity?i("div",{staticClass:"form_cellBd clear",on:{click:function(a){t.areaPicker=!0}}},[i("span",{staticClass:"select-city-label"},[t._v("选择交易城市")]),i("span",{staticClass:"color999 rt size30"},[t._v("\r\n              "+t._s(t.cityVal.name)+"\r\n              "),i("van-icon",{staticClass:"size24",attrs:{name:"arrow"}})],1)]):t._e(),t.industryList&&""!=t.industryList?i("div",{staticClass:"form_cellBd clear",on:{click:function(a){t.industryPicker=!0}}},[i("span",{staticClass:"select-industry-label"},[t._v("选择行业")]),i("span",{staticClass:"color999 rt size30"},[t._v("\r\n              "+t._s(t.industryName)+"\r\n              "),i("van-icon",{attrs:{name:"arrow"}})],1)]):t._e()]),t.isHBFQ?i("div",{staticClass:"select_make"},[i("div",{staticClass:"form_cellBd clear"},[i("span",{staticClass:"select-city-label"},[t._v("分期")]),i("span",{staticClass:"color999 rt size30",attrs:{type:"text"},on:{click:function(a){t.showPicker=!0}}},[t._v("\r\n              "+t._s(t.repay_type)+"\r\n              "),i("van-icon",{attrs:{name:"arrow"}})],1)])]):t._e(),i("van-popup",{attrs:{position:"bottom"},model:{value:t.showPicker,callback:function(a){t.showPicker=a},expression:"showPicker"}},[i("van-picker",{attrs:{"show-toolbar":"",columns:t.columns},on:{cancel:function(a){t.showPicker=!1},confirm:t.onConfirm}})],1),t._e(),i("div",{staticClass:"select_warp"},[i("div",{staticClass:"select_title flex_sb"},[i("div",{staticClass:"w100 flex-row-between"},[i("span",{staticClass:"select-card"},[t._v("请选择储蓄卡")]),i("span",{staticClass:"size28 maincolor",on:{click:function(a){return t.gotoChangeCard("cashCard",t.debitCardMsg.id)}}},[t._v("更换")])])]),t.debitCardMsgAdd?i("div",{staticClass:"card_add"},[i("router-link",{staticClass:"btn2 flex-vertical-centering",attrs:{to:{path:"/addCard",query:{status:"add"}}}},[i("div",{staticClass:"flex-row-center"},[i("img",{staticClass:"add-card-img",attrs:{src:e("3ea7")}}),i("span",{staticClass:"add-card-center-content"},[t._v("添加储蓄卡")])])])],1):t._e(),i("div",{staticClass:"card_warp"},[t.debitCardMsgAdd?t._e():i("div",{staticClass:"select_card2 flex flex_alCen"},[i("div",{staticClass:"card_logo w25"},[t.debitCardMsg.bank_info.bank_logo_image?i("img",{attrs:{src:t.debitCardMsg.bank_info.bank_logo_image.url}}):t._e()]),t.debitCardMsg?i("div",{staticClass:"w75 lineheight70"},[i("h5",{staticClass:"colorfff size30"},[t._v("\r\n                  "+t._s(t.debitCardMsg.bank_info.name)+"\r\n                ")]),i("p",{staticClass:"colorfff size36"},[t._v("\r\n                  "+t._s("**** **** *** "+t.debitCardMsg.card_info.card_no.substr(t.debitCardMsg.card_info.card_no.length-4))+"\r\n                ")])]):t._e()])])])],1)]),t.isSubmit?t._e():i("div",{staticClass:"btn_warp",on:{click:t.payFun}},[t._v("\r\n      确定\r\n    ")]),t.isSubmit?i("div",{staticClass:"btn_warp"},[t._v("\r\n      已提交\r\n    ")]):t._e(),i("van-popup",{attrs:{position:"bottom"},model:{value:t.areaPicker,callback:function(a){t.areaPicker=a},expression:"areaPicker"}},[i("area-search-picker",{staticClass:"select_city",on:{selectArea:t.selectArea}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:t.industryPicker,callback:function(a){t.industryPicker=a},expression:"industryPicker"}},[i("van-picker",{attrs:{"show-toolbar":"",columns:t.industryList},on:{cancel:t.channelCodeCancel,confirm:t.channelCodeConfirm}})],1)],1)},n=[],s=(e("e7e5"),e("d399")),r=e("2c92"),c=e("494e"),o=e("2cdb");function d(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}var l={name:"SelectCard",components:{topMsg:r["a"],AreaSearchPicker:o["a"]},data:function(){var t;return t={showPicker:!1,repay_type:"6期",stagesNum:6,columns:["6期","12期"],isHBFQ:"HBFQ"===this.$util.getQueryVariable("param_type"),channelCode:this.$util.getQueryVariable("code"),totalAmount:100*this.$util.getQueryVariable("amount"),channelName:decodeURIComponent(this.$util.getQueryVariable("channelName")),debitCardMsg:"",debitCardMsgList:"",debitCardMsgAdd:!0,creditCardMsg:"",creditCardMsgList:"",creditCardMsgAdd:!0,isLoading:"",isSubmit:!1,areaList:"",cityVal:"",checkDEBITFlag:!1,checkCreatFlag:!1,areaPicker:!1,cardType1:"DEBIT",cardId1:""},d(t,"cardType1","DEBIT"),d(t,"industryList",[{text:"杭州",texts:"杭州"},{texts:"杭州",text:"宁波"},{texts:"杭州",text:"温州"}]),d(t,"industryPicker",!1),d(t,"industryVal",""),d(t,"industryName",""),d(t,"chooseCity",!0),t},computed:{currentDebitCard:function(){return this.$store.state.currentDebitCard},currentCreditCard:function(){return this.$store.state.currentCreditCard},computeRate:function(){return(100*this.settleMsg.rate).toFixed(2)},computeFee:function(){return(this.settleMsg.fee/100).toFixed(2)},settleMsg:function(){return this.$store.state.settleMsg},wrapTotalAmount:function(){return(this.settleMsg.total_amount/100).toFixed(2)},wrapPaybackAmount:function(){return(this.settleMsg.payback_amount/100).toFixed(2)},cityRecord:{get:function(){return JSON.parse(localStorage.getItem("selectCardArea"))},set:function(t){localStorage.setItem("selectCardArea",JSON.stringify(t))}}},watch:{creditCardMsg:{handler:function(t,a){},deep:!0}},created:function(){this.init(),this.thisTitle(),this.getIndustryListFun(),this.settleMsg||(this.isLoading=this.$toast("请重新下单"),this.$router.push("/proceeds")),this.currentDebitCard?(console.log("如果之前有选择过银行卡的，默认先显示之前选择的银行卡 储蓄卡"),console.log(this.currentDebitCard),this.cardId1=this.currentDebitCard.id,console.log(this.cardId1),this.debitCardMsg=this.currentDebitCard,this.debitCardMsgAdd=!1):this.getCardListFun(),this.currentCreditCard?(console.log("如果之前有选择过银行卡的，默认先显示之前选择的银行卡 信用卡"),console.log(this.currentCreditCard),this.creditCardMsg=this.currentCreditCard,this.creditCardMsgAdd=!1):this.getCreditCardListFun(),this.cityRecord&&(this.cityVal=this.cityRecord),this.chooseCity=this.$store.state.chooseCity},methods:{onConfirm:function(t){this.repay_type=t,"6期"==this.repay_type&&(this.stagesNum=6),"12期"==this.repay_type&&(this.stagesNum=12),this.showPicker=!1},registjudgeNew:function(t){var a=this;a.$api.card.registjudgeNew(t,a.cardId1,"DEBIT").then((function(t){console.log(t.data.data.state);var e=t.data.data.state;3==e?a.$api.card.regchannel(a.cardType1,a.cardId1,a.channelCode).then((function(t){var e=t.data.data.isSign,i=t.data.data.state,n=t.data.data.html;"t"==e&&"000"==i?(console.log("签约"),a.checkCard(a.channelCode,"0","CREDIT")):a.$router.push({path:"/iframe",query:{title:"银行卡签约",url:n}})})).catch((function(t){console.log("储蓄卡注册失败"),console.log(t),Object(s["a"])("储蓄卡注册失败")})):a.checkCard(a.channelCode,"0","CREDIT")})).catch((function(t){console.log(t)}))},checkCreat:function(t,a,e){var i=this,n=this;this.$api.card.txCheck(t,a,e||"CREDIT").then((function(e){console.log(e.data.data.state);var s=e.data.data.data.signType;1==s?n.bindCardSF("CREDIT",a,t,"信用卡签约"):i.checkCreatFlag=!0}))},checkDEBIT:function(t){var a=this,e=this;e.$api.card.registjudgeNew(t,e.cardId1,"DEBIT").then((function(t){console.log(t.data.data.state);var i=t.data.data.state;3==i?e.txCheckBindCard("DEBIT"):(e.checkCreat(e.channelCode,e.creditCardMsg.id,"CREDIT"),a.checkDEBITFlag=!0)})).catch((function(t){console.log(t)}))},selectArea:function(t){this.cityVal=t,this.cityRecord=t,this.areaPicker=!1},channelCodeConfirm:function(t,a){var e=this;e.industryVal=e.industryList[a].channel_industry_id,e.industryName=t.name,this.industryPicker=!1},channelCodeCancel:function(){this.industryPicker=!1},channelCodeChange:function(t,a,e){var i=this;i.industryVal=i.industryList[e].channel_industry_id,i.industryName=a.name},onAddrConfirm:function(t){console.log(t),this.areaPicker=!1,this.cityVal=t[0].name+" "+t[1].name,console.log(this.cityVal)},onAddrCancel:function(){this.areaPicker=!1},init:function(){this.areaList=c["a"]},thisTitle:function(){document.title="选择银行卡"},gotoChangeCard:function(t,a){this.$router.push({path:"/changeCard",query:{type:t,id:a}})},getIndustryListFun:function(){var t=this;t.$api.proceeds.getIndustryList({channelCode:t.channelCode}).then((function(a){a.data.data.forEach((function(t,a){t.text=t.name})),t.industryList=a.data.data})).catch((function(t){console.log(t)}))},getCardListFun:function(){var t=this;t.$api.card.getCardList("DEBIT").then((function(a){console.log(a),t.debitCardMsgList=a.data.data,0!==t.debitCardMsgList.length?(t.debitCardMsgAdd=!1,t.debitCardMsg=t.debitCardMsgList[0],t.$store.commit("SET_CURRENT_DEBIT_CARD",t.debitCardMsg)):t.debitCardMsgAdd=!0}))},getCreditCardListFun:function(){var t=this;t.$api.card.getCardList("CREDIT").then((function(a){t.creditCardMsgList=a.data.data,0!==t.creditCardMsgList.length?(t.creditCardMsgAdd=!1,t.creditCardMsg=t.creditCardMsgList[0],t.$store.commit("SET_CURRENT_CREDIT_CARD",t.creditCardMsg)):t.creditCardMsgAdd=!0})).catch((function(t){console.log(t)}))},payFun:function(){var t=this,a=function(a){return t.$dialog({title:a,showCancelButton:!1,confirmButtonText:"确定",className:"dialog",closeOnClickOverlay:!0})};if(t.debitCardMsg.id)if(t.chooseCity&&!t.cityVal.code)a("请先选择交易城市！");else{var e={channel_code:t.channelCode,deposit_bank_id:t.creditCardMsg.id,payback_bank_id:t.debitCardMsg.id,total_amount:t.totalAmount,industry_id:t.industryVal,settlement_id:t.settleMsg.settlement_id,flag:"huabei"};t.isHBFQ&&(e.stages_num=t.stagesNum),t.chooseCity&&(e.city_code=t.cityVal.code),t.$store.commit("SET_ORDER_DATA",e),t.$dialog({title:"确认即发起交易",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",className:"dialog",closeOnClickOverlay:!0}).then((function(){return t.registjudgeNew(t.channelCode),!1})).catch((function(){console.log("cancel")}))}else a("请先添加储蓄卡！")},txCheckBindCard:function(t){var a=this;a.$api.card.regchannel(t,a.cardId1,a.channelCode).then((function(t){var e=t.data.data.isSign,i=t.data.data.state,n=t.data.data.html;"t"==e&&"000"==i?(console.log("签约"),a.checkCreat(a.channelCode,a.creditCardMsg.id,"CREDIT")):a.$router.push({path:"/iframe",query:{title:"银行卡签约",url:n}})})).catch((function(t){console.log(t),Object(s["a"])("储蓄卡注册失败")}))},bindCardSF:function(t,a,e,i){var n=this;n.$api.card.regchannel(t,a,e).then((function(t){var a=t.data.data.isSign,e=t.data.data.state,s=t.data.data.html;"f"==a&&"000"==e?n.$router.push({path:"/iframe",query:{title:i||"银行卡签约",url:s}}):console.warn("签约绑卡四方,,,t")})).catch((function(t){console.log(t),Object(s["a"])("注册失败")}))},checkCard:function(t,a,e){var i=this,n=this;n.$api.card.bbbindChannelCardtx(t,a,e).then((function(i){console.log("查询渠道绑卡状态成功"),console.log(i.data.data.data.signature);var r=i.data.data.data.signature,c=i.data.data.data.signType;2!==r?n.$api.card.bindChannelCard(e,a,t).then((function(e){s["a"].clear();var i=e.data.data.state,r=e.data.data.platformType||"",c=e.data.data.isSign,o=e.data.data.html;if(console.warn("platformType TODO 定义 四方h5 标:::"+r),console.log(e.data.data.state),"000"!=i){var d=e.data.data.errorMsg;Object(s["a"])(d)}else{if("sf"===r)return"t"===c?(n.payment(),!1):(n.$router.push({path:"/iframe",query:{title:"银行卡签约",url:o}}),!1);n.bindCardSF(n.cardType1,n.cardId1,n.channelCode),n.$router.push({path:"/bindCardT",query:{channelCode:t,cardId:a,cardType:"CREDIT"}})}})).catch((function(){s["a"].clear()})):4==c?n.$router.push({path:"/bindCardTX",query:{channelCode:t,cardId:a,cardType:"CREDIT"}}):n.payment()})).catch((function(t){console.log(t),i.$toast.fail("服务异常")}))},openFrame:function(){api.openFrame({name:"externalSecondUrlFrame",url:"http://www.baidu.com",bgColor:"#fff",rect:{x:0,y:42,w:api.winWidth,h:api.winHeight-42},animation:{type:"none"}})},judgeBindCard:function(){var t=this;if("NONE"===t.settleMsg.pay_provider_config.card_binding_type)return!1;if("INTERNAL_PAGE"===t.settleMsg.pay_provider_config.card_binding_type){if(t.demandChannelCardFun())return!1;t.$router.push({path:"/bindCard",query:{cardId:t.creditCardMsg.id,channelCode:t.channelCode}})}else if("EXTERNAL_URL"===t.settleMsg.pay_provider_config.card_binding_type)return!0},demandChannelCardFun:function(){var t=this;t.$api.card.demandChannelCard("CREDIT",t.creditCardMsg.id,t.channelCode).then((function(t){return!!t.data.data.has_succeeded})).catch((function(t){console.log(t)}))}}},u=l,h=(e("5f9d"),e("d9b1"),e("2877")),C=Object(h["a"])(u,i,n,!1,null,"2f1ddd97",null);a["default"]=C.exports},"1cf5":function(t,a,e){},"24d1":function(t,a,e){"use strict";var i=e("7af0"),n=e.n(i);n.a},"2cdb":function(t,a,e){"use strict";var i,n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"bgfff"},[e("div",[t._m(0),e("div",{staticClass:"search_warp"},[e("i",{staticClass:"icon_search"}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchValue,expression:"searchValue"}],staticClass:"search_input",attrs:{type:"text",placeholder:"请输入城市名称关键词"},domProps:{value:t.searchValue},on:{input:function(a){a.target.composing||(t.searchValue=a.target.value)}}})])]),e("div",{staticClass:"search_content selectcity"},[e("mt-index-list",{attrs:{height:456}},t._l(t.bankListArr,(function(a,i){return e("mt-index-section",{key:i,attrs:{index:i}},t._l(a,(function(a,i){return e("li",{key:i,staticClass:"search_item",on:{click:function(e){return t.clickCard(a)}}},[t._v("\n          "+t._s(a.name)+"\n        ")])})),0)})),1)],1)])},s=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"search_title"},[e("h5",{staticClass:"size36 color333"},[t._v("\n        选择城市\n      ")])])}],r=e("76a0");e("8635"),e("f1a6");function c(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}var o={name:"AreaSearchPicker",components:(i={},c(i,r["IndexList"].name,r["IndexList"]),c(i,r["IndexSection"].name,r["IndexSection"]),i),data:function(){return{bankListArr:{},searchValue:"",resultsList:""}},computed:{bankList:function(){return this.$store.state.bankList}},watch:{searchValue:function(t,a){var e=String(t).toUpperCase(),i=[];this.resultsList.forEach((function(t){-1===String(t.name).indexOf(e)&&-1===String(t.first_pinyin_letter).indexOf(e)||i.push(t)})),this.bankListArr=i.reduce((function(t,a){return t[a.first_pinyin_letter[0]]||(t[a.first_pinyin_letter[0]]=[]),t[a.first_pinyin_letter[0]].push(a),t}),{}),this.bankListArr=this.objKeySort(this.bankListArr)}},created:function(){this.getCityListFun()},methods:{thisTitle:function(){document.title="选择银行卡"},getCityListFun:function(){var t=this;t.$api.proceeds.getCityList().then((function(a){console.log(a),t.resultsList=a.data.data,t.bankListArr=t.resultsList.reduce((function(t,a){return console.log(t),t[a.first_pinyin_letter[0]]||(t[a.first_pinyin_letter[0]]=[]),t[a.first_pinyin_letter[0]].push(a),t}),{}),t.bankListArr=t.objKeySort(t.bankListArr)}))},objKeySort:function(t){for(var a=Object.keys(t).sort(),e={},i=0;i<a.length;i++)e[a[i]]=t[a[i]];return e},clickCard:function(t){this.$emit("selectArea",t)}}},d=o,l=(e("24d1"),e("731c"),e("2877")),u=Object(l["a"])(d,n,s,!1,null,"44d68a92",null);a["a"]=u.exports},"3ea7":function(t,a){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAADxElEQVRYR82Yf2gbZRjHv9+7ptUVZJhphYkoOP8Q9Z8qrqOapE6GIFMRpzhN7+YfazKHUCgM/CcO0aJoocTLBo6kBh1rRR2CsLXmsglTQe1f4o8pCloctA6nibXSu0cuNVnSNu1dctO8EMglz/N9Pnnufb/3viE8DnNE24h27gDlXhDXi/BaEpshWARkRoAZgN/bkJNW0ZrcMZQteilBt8G5Q/oDtPEMiF4AAZd5fwEwhfYrfQNjH7rJWRcoZ+ghUoYBbnUjWD9GJm2LB+55Ov3FWjp1gcbHH1E3ne8coXB/cyAXswWwCXk2EssM19NcFejM609dufC3fQzEdr9gqnVImRCruCeyb6KwXH8F0OlR/SqrTT4FecOlgClrCuTzy+aLd20bnJivga2+OHy4O7DFvnWK4N2XEuYiFI72xdK7AUj5s5oOmYaWAjnwX8BUzaxEJJZ5bgWQmdLCAE2vMF1btuLG3t1YXPgTX55IovDrT54kRGCrsnhLaF/2Kyex0qGcoX1C8k4valTa0LsnCbWtvZR24ZezmD7+oheJUixF3gnHMw9XgExDexDku16V2jdsxLboq5W0heJv+Dg76FXGmUJiW7zd8ahSh0xD/+hfB/Yk5h9QaVaP98XSj3IqGQ2qinoORJsnGgA+A52fCxaupmno/SAyXmGceD+BSvUXJeIAZUE80RJAkGHmU9opadAI/e4QIW8xZ2jfkLypXofKPhPo6GykiZWc+d9nXfiU5JlL6UUCG1arttxnmiJy4VMi8q3ToQskr1gdSEWvnoQa6GiWZck4z32H6fdeqKtVBmqtW9Zykzpv6GNCRBu5J36vMjjLPmdoj5N8syWAHGNslUcHgLnZYOGapYdrSjMBhr12yc9bRsEb4Xi6vwSUM/p3ksrx/w9IRIHaHYodma5s0MyUfgZAjxcoKrU+tZ7PrGFAxyLxzGOVDZrzZioZ7VFV1YHyNJrdwjpHcEWRm0MDmbM1QM5F/pD2kgiHPBE1GUxgMBxLj5Rlak4diQSUUJf+NoCHmqzjKl2AVF8sHa8OXnFQPPHyk52BTvUUyW5Xqg0HyeRssHjfrl0T1ppAzpcfjO7vuDzwxxGAziHO9yHAyFywMLQcZsUcWl7ZTGkHAD4PQPWJagGCvZF4eqye3rp/x5w2ordZVA8CshPguvGrFRKIRZGjisKD5dXUMFA5Mf+adocoiIvwfhKbXHbsZxH7faocjezNfO0mx/MvlkRCMbt+6CG4neB1AmzG0ssSyIwCzNiCH6lYJyMD2c/cQFTH/APz4KymnbiUAgAAAABJRU5ErkJggg=="},"5f9d":function(t,a,e){"use strict";var i=e("65a6"),n=e.n(i);n.a},"65a6":function(t,a,e){},"731c":function(t,a,e){"use strict";var i=e("da6e"),n=e.n(i);n.a},"7af0":function(t,a,e){},d9b1:function(t,a,e){"use strict";var i=e("1cf5"),n=e.n(i);n.a},da6e:function(t,a,e){}}]);